INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_ValUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '9', 'verbose': 20, 'log_file': '../log/MLP_FOCF_ValUnf__taobaoserendipity_u_neuroticism__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_neuroticism'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_ValUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 0
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:root:Optimizer: Adam
INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_ValUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '0', 'verbose': 20, 'log_file': '../log/MLP_FOCF_ValUnf__taobaoserendipity_u_neuroticism__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_neuroticism'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_ValUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 576.1983, l2 = 22.9887
INFO:root:Epoch     1 [775.5 s]
 validation= 0.5455,0.1174 [200.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 464.0465, l2 = 44.1444
INFO:root:Epoch     2 [794.3 s]
 validation= 0.5672,0.1251 [192.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 405.8265, l2 = 58.9163
INFO:root:Epoch     3 [822.1 s]
 validation= 0.5871,0.1320 [198.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 370.8445, l2 = 68.1957
INFO:root:Epoch     4 [796.3 s]
 validation= 0.6033,0.1375 [191.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 348.1150, l2 = 73.8710
INFO:root:Epoch     5 [800.9 s]
 validation= 0.6193,0.1437 [195.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 331.0017, l2 = 77.4106
INFO:root:Epoch     6 [807.6 s]
 validation= 0.6288,0.1467 [187.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 317.3329, l2 = 79.6360
INFO:root:Epoch     7 [794.9 s]
 validation= 0.6356,0.1495 [171.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 307.0342, l2 = 81.1954
INFO:root:Epoch     8 [788.2 s]
 validation= 0.6410,0.1518 [168.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 299.1431, l2 = 82.3288
INFO:root:Epoch     9 [785.7 s]
 validation= 0.6433,0.1528 [187.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 292.2927, l2 = 83.1902
INFO:root:Epoch    10 [783.7 s]
 validation= 0.6471,0.1542 [185.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 286.8020, l2 = 83.8676
INFO:root:Epoch    11 [768.6 s]
 validation= 0.6536,0.1557 [193.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 282.2808, l2 = 84.4200
INFO:root:Epoch    12 [778.6 s]
 validation= 0.6543,0.1564 [168.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 278.2116, l2 = 84.9266
INFO:root:Epoch    13 [781.9 s]
 validation= 0.6548,0.1572 [171.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 274.9326, l2 = 85.4963
INFO:root:Epoch    14 [776.1 s]
 validation= 0.6602,0.1582 [169.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 271.7167, l2 = 85.9882
INFO:root:Epoch    15 [772.8 s]
 validation= 0.6604,0.1581 [170.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 268.9448, l2 = 86.4087
INFO:root:Epoch    16 [776.2 s]
 validation= 0.6598,0.1584 [168.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 266.3459, l2 = 86.7526
INFO:root:Epoch    17 [780.3 s]
 validation= 0.6594,0.1583 [174.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 264.4732, l2 = 87.1096
INFO:root:Epoch    18 [789.8 s]
 validation= 0.6621,0.1595 [171.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 262.0891, l2 = 87.4211
INFO:root:Epoch    19 [780.7 s]
 validation= 0.6653,0.1604 [184.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 260.0580, l2 = 87.6636
INFO:root:Epoch    20 [783.1 s]
 validation= 0.6636,0.1598 [186.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 258.3005, l2 = 87.9279
INFO:root:Epoch    21 [770.8 s]
 validation= 0.6655,0.1603 [173.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 257.1053, l2 = 88.0877
INFO:root:Epoch    22 [773.0 s]
 validation= 0.6637,0.1602 [175.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 255.2489, l2 = 88.3116
INFO:root:Epoch    23 [792.9 s]
 validation= 0.6675,0.1615 [179.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 253.9090, l2 = 88.4941
INFO:root:Epoch    24 [773.5 s]
 validation= 0.6673,0.1606 [180.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 252.4102, l2 = 88.6984
INFO:root:Epoch    25 [763.6 s]
 validation= 0.6679,0.1614 [167.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 251.1515, l2 = 88.8228
INFO:root:Epoch    26 [744.4 s]
 validation= 0.6686,0.1614 [170.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 250.0855, l2 = 88.9785
INFO:root:Epoch    27 [744.6 s]
 validation= 0.6696,0.1618 [162.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 249.2119, l2 = 89.1642
INFO:root:Epoch    28 [732.3 s]
 validation= 0.6693,0.1622 [175.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 247.9508, l2 = 89.3245
INFO:root:Epoch    29 [736.9 s]
 validation= 0.6684,0.1617 [164.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 247.3869, l2 = 89.4745
INFO:root:Epoch    30 [713.5 s]
 validation= 0.6696,0.1613 [187.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 245.9405, l2 = 89.5823
INFO:root:Epoch    31 [720.3 s]
 validation= 0.6717,0.1630 [166.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 245.2640, l2 = 89.7326
INFO:root:Epoch    32 [694.3 s]
 validation= 0.6714,0.1625 [154.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 244.6670, l2 = 89.8145
INFO:root:Epoch    33 [687.9 s]
 validation= 0.6708,0.1628 [174.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 244.0213, l2 = 89.8997
INFO:root:Epoch    34 [702.0 s]
 validation= 0.6713,0.1627 [171.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 243.1296, l2 = 90.0216
INFO:root:Epoch    35 [693.2 s]
 validation= 0.6761,0.1643 [178.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 242.4236, l2 = 90.1496
INFO:root:Epoch    36 [688.7 s]
 validation= 0.6729,0.1631 [164.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 241.9810, l2 = 90.3287
INFO:root:Epoch    37 [700.1 s]
 validation= 0.6749,0.1640 [173.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 241.4046, l2 = 90.4731
INFO:root:Epoch    38 [696.2 s]
 validation= 0.6743,0.1632 [167.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 240.5089, l2 = 90.5877
INFO:root:Epoch    39 [697.2 s]
 validation= 0.6774,0.1643 [177.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.2637, l2 = 90.6985
INFO:root:Epoch    40 [703.8 s]
 validation= 0.6774,0.1645 [164.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.3077, l2 = 90.8443
INFO:root:Epoch    41 [698.3 s]
 validation= 0.6762,0.1636 [163.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.0744, l2 = 90.8351
INFO:root:Epoch    42 [696.3 s]
 validation= 0.6760,0.1635 [161.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.1241, l2 = 90.9673
INFO:root:Epoch    43 [692.9 s]
 validation= 0.6788,0.1644 [165.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 237.9424, l2 = 91.0463
INFO:root:Epoch    44 [691.8 s]
 validation= 0.6774,0.1643 [163.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.5331, l2 = 91.1127
INFO:root:Epoch    45 [685.7 s]
 validation= 0.6771,0.1643 [162.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.7211, l2 = 91.1388
INFO:root:Epoch    46 [694.7 s]
 validation= 0.6800,0.1656 [158.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 237.0078, l2 = 91.2459
INFO:root:Epoch    47 [693.4 s]
 validation= 0.6779,0.1648 [160.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.5407, l2 = 91.2459
INFO:root:Epoch    48 [687.2 s]
 validation= 0.6811,0.1653 [162.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 236.1528, l2 = 91.3453
INFO:root:Epoch    49 [692.9 s]
 validation= 0.6796,0.1650 [165.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.7048, l2 = 91.3833
INFO:root:Epoch    50 [687.0 s]
 validation= 0.6801,0.1657 [157.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.5700, l2 = 91.4032
INFO:root:Epoch    51 [683.5 s]
 validation= 0.6804,0.1655 [158.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.3934, l2 = 91.4856
INFO:root:Epoch    52 [684.0 s]
 validation= 0.6801,0.1652 [169.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.2995, l2 = 91.5490
INFO:root:Epoch    53 [681.5 s]
 validation= 0.6817,0.1666 [156.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 234.6815, l2 = 91.6086
INFO:root:Epoch    54 [677.0 s]
 validation= 0.6809,0.1661 [165.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 234.3282, l2 = 91.5949
INFO:root:Epoch    55 [682.1 s]
 validation= 0.6807,0.1655 [164.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.7389, l2 = 91.6440
INFO:root:Epoch    56 [680.0 s]
 validation= 0.6785,0.1653 [160.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.8003, l2 = 91.6745
INFO:root:Epoch    57 [690.1 s]
 validation= 0.6784,0.1645 [158.9 s] ndcg@10,f1@10
INFO:root:Early stop at 57 based on validation result.
INFO:root:Best Iter (validation) =    53	 valid= 0.6817,0.1666 [51816.7 s] ndcg@10,f1@10
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_neuroticism loss = 0.6950
INFO:root:Epoch     1 [1.8 s]
INFO:root:u_neuroticism disc test = 0.5055,0.4881,0.3905,0.4881 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_neuroticism loss = 0.6917
INFO:root:

INFO:root:u_neuroticism loss = 0.6489
INFO:root:Epoch   126 [1.6 s]
INFO:root:u_neuroticism disc test = 0.5386,0.5409,0.5381,0.5409 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_neuroticism loss = 0.6110
INFO:root:Epoch   251 [1.7 s]
INFO:root:u_neuroticism disc test = 0.5426,0.5435,0.5426,0.5435 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_neuroticism loss = 0.5764
INFO:root:Epoch   376 [1.5 s]
INFO:root:u_neuroticism disc test = 0.5343,0.5351,0.5343,0.5351 auc, acc, f1_macro, f1_micro
INFO:root:u_neuroticism best auc: 0.5639
INFO:root:And the corresponding u_neuroticism best disc test= 0.5639,0.5624,0.5623,0.5624 auc, acc, f1_macro, f1_micro
INFO:root:Load u_neuroticism discriminator model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/u_neuroticism_eval_disc.pt
INFO:root:Test After Training = 0.6839,0.1666 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 0.026080536557811396
INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_ValUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '4', 'verbose': 20, 'log_file': '../log/MLP_FOCF_ValUnf__taobaoserendipity_u_neuroticism__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_neuroticism'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_ValUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:numexpr.utils:Note: detected 96 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 96 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
INFO:numexpr.utils:NumExpr defaulting to 8 threads.
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 576.2153, l2 = 22.9261
INFO:root:Epoch     1 [1419.2 s]
 validation= 0.5431,0.1168 [311.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 464.6946, l2 = 43.9365
INFO:root:Epoch     2 [1284.3 s]
 validation= 0.5688,0.1257 [401.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 406.9160, l2 = 58.5802
INFO:root:Epoch     3 [1320.8 s]
 validation= 0.5892,0.1325 [261.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 371.5452, l2 = 67.7987
INFO:root:Epoch     4 [1247.3 s]
 validation= 0.6102,0.1395 [318.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 348.1378, l2 = 73.4974
INFO:root:Epoch     5 [1238.1 s]
 validation= 0.6228,0.1440 [315.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 330.2349, l2 = 77.0413
INFO:root:Epoch     6 [1136.7 s]
 validation= 0.6308,0.1476 [231.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 316.3551, l2 = 79.3675
INFO:root:Epoch     7 [1050.5 s]
 validation= 0.6396,0.1503 [230.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 306.2049, l2 = 81.0518
INFO:root:Epoch     8 [1302.3 s]
 validation= 0.6431,0.1519 [195.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 298.6203, l2 = 82.2459
INFO:root:Epoch     9 [1028.3 s]
 validation= 0.6471,0.1542 [236.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 292.5434, l2 = 83.2662
INFO:root:Epoch    10 [1069.5 s]
 validation= 0.6510,0.1551 [380.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 287.0838, l2 = 84.1012
INFO:root:Epoch    11 [1162.8 s]
 validation= 0.6538,0.1564 [341.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 283.0604, l2 = 84.8074
INFO:root:Epoch    12 [1136.1 s]
 validation= 0.6566,0.1575 [268.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 279.3309, l2 = 85.4370
INFO:root:Epoch    13 [1301.3 s]
 validation= 0.6571,0.1573 [235.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 276.3724, l2 = 86.0182
INFO:root:Epoch    14 [1111.7 s]
 validation= 0.6608,0.1583 [340.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 273.7481, l2 = 86.5167
INFO:root:Epoch    15 [1185.0 s]
 validation= 0.6595,0.1577 [335.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 270.7763, l2 = 86.9891
INFO:root:Epoch    16 [1322.0 s]
 validation= 0.6603,0.1584 [306.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 268.6832, l2 = 87.3360
INFO:root:Epoch    17 [1325.6 s]
 validation= 0.6632,0.1590 [218.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 266.5950, l2 = 87.7280
INFO:root:Epoch    18 [1276.1 s]
 validation= 0.6638,0.1595 [365.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 264.4683, l2 = 87.9664
INFO:root:Epoch    19 [1097.6 s]
 validation= 0.6619,0.1590 [364.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 262.6241, l2 = 88.2622
INFO:root:Epoch    20 [1139.6 s]
 validation= 0.6650,0.1599 [353.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 260.9304, l2 = 88.4509
INFO:root:Epoch    21 [1311.2 s]
 validation= 0.6633,0.1600 [214.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 259.5518, l2 = 88.7662
INFO:root:Epoch    22 [1329.2 s]
 validation= 0.6627,0.1593 [297.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 258.2662, l2 = 89.0187
INFO:root:Epoch    23 [1201.8 s]
 validation= 0.6642,0.1607 [312.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 256.6050, l2 = 89.2296
INFO:root:Epoch    24 [1062.2 s]
 validation= 0.6663,0.1606 [363.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 255.2808, l2 = 89.3496
INFO:root:Epoch    25 [1184.9 s]
 validation= 0.6661,0.1604 [247.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 253.9575, l2 = 89.5497
INFO:root:Epoch    26 [1200.4 s]
 validation= 0.6658,0.1602 [253.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 252.8008, l2 = 89.6891
INFO:root:Epoch    27 [1253.4 s]
 validation= 0.6695,0.1615 [334.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 251.6940, l2 = 89.8855
INFO:root:Epoch    28 [1045.9 s]
 validation= 0.6689,0.1612 [279.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 250.5442, l2 = 90.1010
INFO:root:Epoch    29 [1138.3 s]
 validation= 0.6706,0.1615 [270.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 249.7307, l2 = 90.2425
INFO:root:Epoch    30 [1311.9 s]
 validation= 0.6681,0.1605 [234.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 248.2411, l2 = 90.3832
INFO:root:Epoch    31 [1093.4 s]
 validation= 0.6697,0.1611 [273.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 247.7113, l2 = 90.5025
INFO:root:Epoch    32 [1389.1 s]
 validation= 0.6725,0.1625 [281.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 246.7509, l2 = 90.6252
INFO:root:Epoch    33 [1421.1 s]
 validation= 0.6706,0.1615 [183.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 245.6825, l2 = 90.7199
INFO:root:Epoch    34 [1555.2 s]
 validation= 0.6695,0.1613 [206.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 244.7758, l2 = 90.8918
INFO:root:Epoch    35 [1311.1 s]
 validation= 0.6745,0.1630 [270.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 243.9387, l2 = 90.9634
INFO:root:Epoch    36 [1220.5 s]
 validation= 0.6728,0.1627 [390.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 243.3845, l2 = 91.0718
INFO:root:Epoch    37 [1822.6 s]
 validation= 0.6734,0.1626 [343.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 242.7587, l2 = 91.1615
INFO:root:Epoch    38 [1862.1 s]
 validation= 0.6748,0.1630 [230.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 242.0289, l2 = 91.3451
INFO:root:Epoch    39 [1613.8 s]
 validation= 0.6741,0.1628 [246.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 241.4315, l2 = 91.4982
INFO:root:Epoch    40 [1870.0 s]
 validation= 0.6765,0.1637 [326.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.5461, l2 = 91.6110
INFO:root:Epoch    41 [1818.4 s]
 validation= 0.6761,0.1632 [252.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 240.4430, l2 = 91.7437
INFO:root:Epoch    42 [1681.5 s]
 validation= 0.6771,0.1637 [454.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.0665, l2 = 91.7740
INFO:root:Epoch    43 [1644.9 s]
 validation= 0.6759,0.1639 [370.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.0949, l2 = 91.8487
INFO:root:Epoch    44 [1483.2 s]
 validation= 0.6767,0.1640 [411.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 238.7190, l2 = 91.9625
INFO:root:Epoch    45 [1523.8 s]
 validation= 0.6752,0.1637 [416.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 238.3389, l2 = 92.0150
INFO:root:Epoch    46 [1625.0 s]
 validation= 0.6780,0.1650 [319.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 237.8454, l2 = 92.1700
INFO:root:Epoch    47 [1553.2 s]
 validation= 0.6782,0.1644 [430.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 237.3965, l2 = 92.1576
INFO:root:Epoch    48 [1522.7 s]
 validation= 0.6788,0.1647 [285.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 236.9521, l2 = 92.2728
INFO:root:Epoch    49 [1326.7 s]
 validation= 0.6781,0.1640 [278.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.5730, l2 = 92.3575
INFO:root:Epoch    50 [935.3 s]
 validation= 0.6774,0.1639 [374.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.3774, l2 = 92.4554
INFO:root:Epoch    51 [917.0 s]
 validation= 0.6799,0.1644 [250.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 236.0300, l2 = 92.5000
INFO:root:Epoch    52 [883.4 s]
 validation= 0.6806,0.1645 [225.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 235.6152, l2 = 92.5965
INFO:root:Epoch    53 [822.6 s]
 validation= 0.6803,0.1651 [205.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.5130, l2 = 92.7227
INFO:root:Epoch    54 [801.7 s]
 validation= 0.6789,0.1643 [195.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.1834, l2 = 92.7471
INFO:root:Epoch    55 [841.1 s]
 validation= 0.6796,0.1646 [168.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 234.5556, l2 = 92.7727
INFO:root:Epoch    56 [835.7 s]
 validation= 0.6796,0.1647 [216.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 234.2411, l2 = 92.7933
INFO:root:Epoch    57 [816.5 s]
 validation= 0.6819,0.1654 [227.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 234.0460, l2 = 92.8495
INFO:root:Epoch    58 [952.1 s]
 validation= 0.6819,0.1658 [213.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.7139, l2 = 92.8321
INFO:root:Epoch    59 [968.1 s]
 validation= 0.6824,0.1659 [249.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 233.2753, l2 = 92.8683
INFO:root:Epoch    60 [928.6 s]
 validation= 0.6827,0.1658 [209.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 233.0574, l2 = 92.9219
INFO:root:Epoch    61 [964.6 s]
 validation= 0.6823,0.1656 [201.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.9760, l2 = 92.9657
INFO:root:Epoch    62 [923.5 s]
 validation= 0.6834,0.1665 [259.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 232.3554, l2 = 93.0159
INFO:root:Epoch    63 [894.7 s]
 validation= 0.6824,0.1654 [218.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.3766, l2 = 93.0511
INFO:root:Epoch    64 [941.3 s]
 validation= 0.6829,0.1657 [181.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.4601, l2 = 93.0948
INFO:root:Epoch    65 [925.2 s]
 validation= 0.6818,0.1653 [226.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.9803, l2 = 93.0783
INFO:root:Epoch    66 [919.9 s]
 validation= 0.6833,0.1658 [204.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.6142, l2 = 93.0560
INFO:root:Epoch    67 [797.9 s]
 validation= 0.6818,0.1657 [178.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.5503, l2 = 93.0881
INFO:root:Epoch    68 [721.0 s]
 validation= 0.6807,0.1652 [168.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.5107, l2 = 93.1264
INFO:root:Epoch    69 [710.7 s]
 validation= 0.6853,0.1670 [151.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 231.0863, l2 = 93.1343
INFO:root:Epoch    70 [711.5 s]
 validation= 0.6842,0.1662 [170.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.0131, l2 = 93.2366
INFO:root:Epoch    71 [714.3 s]
 validation= 0.6848,0.1666 [170.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.2371, l2 = 93.3450
INFO:root:Epoch    72 [708.4 s]
 validation= 0.6838,0.1660 [135.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.0061, l2 = 93.3817
INFO:root:Epoch    73 [612.4 s]
 validation= 0.6840,0.1665 [133.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.7216, l2 = 93.4135
INFO:root:Epoch    74 [608.1 s]
 validation= 0.6847,0.1667 [132.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.1886, l2 = 93.4292
INFO:root:Epoch    75 [606.3 s]
 validation= 0.6843,0.1658 [134.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.9236, l2 = 93.4657
INFO:root:Epoch    76 [607.9 s]
 validation= 0.6850,0.1665 [133.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.1053, l2 = 93.5515
INFO:root:Epoch    77 [606.1 s]
 validation= 0.6854,0.1665 [134.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 230.1055, l2 = 93.5185
INFO:root:Epoch    78 [612.1 s]
 validation= 0.6836,0.1659 [132.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.8323, l2 = 93.5535
INFO:root:Epoch    79 [607.1 s]
 validation= 0.6849,0.1667 [138.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.5554, l2 = 93.5177
INFO:root:Epoch    80 [608.9 s]
 validation= 0.6830,0.1662 [137.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.3730, l2 = 93.5779
INFO:root:Epoch    81 [614.5 s]
 validation= 0.6828,0.1656 [136.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.5770, l2 = 93.6321
INFO:root:Epoch    82 [606.7 s]
 validation= 0.6840,0.1657 [134.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.1161, l2 = 93.5840
INFO:root:Epoch    83 [607.5 s]
 validation= 0.6857,0.1661 [132.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 228.8807, l2 = 93.6459
INFO:root:Epoch    84 [612.0 s]
 validation= 0.6849,0.1662 [134.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.7545, l2 = 93.5991
INFO:root:Epoch    85 [610.0 s]
 validation= 0.6844,0.1664 [133.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.9714, l2 = 93.5951
INFO:root:Epoch    86 [608.2 s]
 validation= 0.6856,0.1667 [132.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.6628, l2 = 93.6343
INFO:root:Epoch    87 [609.1 s]
 validation= 0.6854,0.1666 [133.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.6075, l2 = 93.6851
INFO:root:Epoch    88 [601.1 s]
 validation= 0.6844,0.1668 [132.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.4240, l2 = 93.7388
INFO:root:Epoch    89 [602.4 s]
 validation= 0.6834,0.1658 [133.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.4728, l2 = 93.7454
INFO:root:Epoch    90 [602.0 s]
 validation= 0.6863,0.1669 [133.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 228.3693, l2 = 93.6876
INFO:root:Epoch    91 [604.6 s]
 validation= 0.6851,0.1664 [131.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.8873, l2 = 93.6966
INFO:root:Epoch    92 [599.5 s]
 validation= 0.6866,0.1672 [133.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 228.3583, l2 = 93.7078
INFO:root:Epoch    93 [571.6 s]
 validation= 0.6870,0.1670 [132.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 227.8293, l2 = 93.6637
INFO:root:Epoch    94 [563.8 s]
 validation= 0.6861,0.1669 [133.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.4156, l2 = 93.6861
INFO:root:Epoch    95 [566.1 s]
 validation= 0.6893,0.1683 [132.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 227.7607, l2 = 93.6980
INFO:root:Epoch    96 [583.6 s]
 validation= 0.6864,0.1673 [154.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.8636, l2 = 93.6601
INFO:root:Epoch    97 [610.7 s]
 validation= 0.6861,0.1670 [132.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.4802, l2 = 93.7464
INFO:root:Epoch    98 [564.3 s]
 validation= 0.6886,0.1683 [132.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.2031, l2 = 93.7222
INFO:root:Epoch    99 [565.3 s]
 validation= 0.6868,0.1671 [132.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.2040, l2 = 93.7899
INFO:root:Epoch   100 [566.0 s]
 validation= 0.6846,0.1664 [137.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.2241, l2 = 93.8450
INFO:root:Epoch   101 [565.8 s]
 validation= 0.6890,0.1682 [133.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.9172, l2 = 93.8814
INFO:root:Epoch   102 [563.9 s]
 validation= 0.6874,0.1673 [133.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.8101, l2 = 93.7959
INFO:root:Epoch   103 [610.1 s]
 validation= 0.6889,0.1679 [137.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.9527, l2 = 93.8063
INFO:root:Epoch   104 [574.2 s]
 validation= 0.6876,0.1669 [150.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.5395, l2 = 93.8172
INFO:root:Epoch   105 [609.7 s]
 validation= 0.6886,0.1681 [134.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.4941, l2 = 93.8146
INFO:root:Epoch   106 [609.5 s]
 validation= 0.6885,0.1678 [156.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.6086, l2 = 93.8097
INFO:root:Epoch   107 [636.9 s]
 validation= 0.6859,0.1666 [135.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.4251, l2 = 93.7569
INFO:root:Epoch   108 [581.5 s]
 validation= 0.6891,0.1681 [168.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.2742, l2 = 93.8392
INFO:root:Epoch   109 [676.4 s]
 validation= 0.6870,0.1670 [141.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.2099, l2 = 93.9445
INFO:root:Epoch   110 [575.3 s]
 validation= 0.6869,0.1668 [133.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.3019, l2 = 93.9433
INFO:root:Epoch   111 [571.2 s]
 validation= 0.6883,0.1677 [134.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.4088, l2 = 93.9879
INFO:root:Epoch   112 [565.4 s]
 validation= 0.6876,0.1672 [133.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.3753, l2 = 93.9576
INFO:root:Epoch   113 [569.0 s]
 validation= 0.6866,0.1671 [133.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.2546, l2 = 93.9811
INFO:root:Epoch   114 [570.6 s]
 validation= 0.6870,0.1670 [133.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 225.9922, l2 = 94.0797
INFO:root:Epoch   115 [565.7 s]
 validation= 0.6891,0.1682 [132.2 s] ndcg@10,f1@10
INFO:root:Early stop at 115 based on validation result.
INFO:root:Best Iter (validation) =    95	 valid= 0.6893,0.1683 [136242.9 s] ndcg@10,f1@10
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_neuroticism loss = 0.6948
INFO:root:Epoch     1 [1.7 s]
INFO:root:u_neuroticism disc test = 0.5118,0.4952,0.4085,0.4952 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_neuroticism loss = 0.6914
INFO:root:

INFO:root:u_neuroticism loss = 0.6447
INFO:root:Epoch   126 [1.4 s]
INFO:root:u_neuroticism disc test = 0.5497,0.5523,0.5490,0.5523 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_neuroticism loss = 0.6067
INFO:root:Epoch   251 [1.4 s]
INFO:root:u_neuroticism disc test = 0.5484,0.5518,0.5468,0.5518 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_neuroticism loss = 0.5770
INFO:root:Epoch   376 [1.3 s]
INFO:root:u_neuroticism disc test = 0.5448,0.5483,0.5430,0.5483 auc, acc, f1_macro, f1_micro
INFO:root:u_neuroticism best auc: 0.5711
INFO:root:And the corresponding u_neuroticism best disc test= 0.5711,0.5743,0.5701,0.5743 auc, acc, f1_macro, f1_micro
INFO:root:Load u_neuroticism discriminator model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_neuroticism_neg_sample=1000/u_neuroticism_eval_disc.pt
INFO:root:Test After Training = 0.6889,0.1674 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 0.02336827397697927

INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_AbsUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '3', 'verbose': 20, 'log_file': '../log/MLP_FOCF_AbsUnf__taobaoserendipity_u_extraversion__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_extraversion'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_AbsUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 572.2808, l2 = 23.5305
INFO:root:Epoch     1 [877.6 s]
 validation= 0.5470,0.1180 [189.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 460.5251, l2 = 44.2459
INFO:root:Epoch     2 [918.8 s]
 validation= 0.5699,0.1252 [188.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 404.7465, l2 = 58.7001
INFO:root:Epoch     3 [885.5 s]
 validation= 0.5906,0.1324 [184.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 367.9802, l2 = 67.8763
INFO:root:Epoch     4 [893.6 s]
 validation= 0.6091,0.1388 [196.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 341.6691, l2 = 73.3098
INFO:root:Epoch     5 [913.2 s]
 validation= 0.6270,0.1455 [177.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 322.3580, l2 = 76.3905
INFO:root:Epoch     6 [905.0 s]
 validation= 0.6357,0.1489 [189.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 309.4004, l2 = 78.2389
INFO:root:Epoch     7 [917.0 s]
 validation= 0.6439,0.1520 [184.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 300.1199, l2 = 79.3672
INFO:root:Epoch     8 [901.1 s]
 validation= 0.6501,0.1540 [191.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 293.2418, l2 = 80.1445
INFO:root:Epoch     9 [896.7 s]
 validation= 0.6524,0.1548 [172.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 287.9854, l2 = 80.6962
INFO:root:Epoch    10 [871.8 s]
 validation= 0.6552,0.1560 [183.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 283.5821, l2 = 81.2196
INFO:root:Epoch    11 [888.1 s]
 validation= 0.6590,0.1573 [185.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 279.9886, l2 = 81.6534
INFO:root:Epoch    12 [898.5 s]
 validation= 0.6609,0.1577 [181.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 276.3159, l2 = 82.1185
INFO:root:Epoch    13 [905.1 s]
 validation= 0.6645,0.1593 [176.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 273.7593, l2 = 82.6136
INFO:root:Epoch    14 [904.3 s]
 validation= 0.6670,0.1598 [184.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 270.7047, l2 = 83.0960
INFO:root:Epoch    15 [883.1 s]
 validation= 0.6675,0.1595 [172.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 268.3331, l2 = 83.5739
INFO:root:Epoch    16 [887.6 s]
 validation= 0.6668,0.1602 [174.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 266.0631, l2 = 83.9042
INFO:root:Epoch    17 [886.0 s]
 validation= 0.6706,0.1609 [181.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 263.7904, l2 = 84.2358
INFO:root:Epoch    18 [879.3 s]
 validation= 0.6719,0.1616 [179.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 261.3066, l2 = 84.5165
INFO:root:Epoch    19 [881.7 s]
 validation= 0.6748,0.1629 [190.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 259.2938, l2 = 84.7725
INFO:root:Epoch    20 [892.0 s]
 validation= 0.6735,0.1622 [187.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 257.5726, l2 = 85.0408
INFO:root:Epoch    21 [880.8 s]
 validation= 0.6761,0.1635 [178.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 255.7472, l2 = 85.3508
INFO:root:Epoch    22 [897.8 s]
 validation= 0.6734,0.1624 [181.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 253.8680, l2 = 85.5745
INFO:root:Epoch    23 [904.8 s]
 validation= 0.6776,0.1641 [179.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 252.0110, l2 = 85.7588
INFO:root:Epoch    24 [885.5 s]
 validation= 0.6767,0.1634 [182.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 250.5123, l2 = 85.8812
INFO:root:Epoch    25 [872.8 s]
 validation= 0.6790,0.1647 [182.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 248.8677, l2 = 86.0101
INFO:root:Epoch    26 [863.8 s]
 validation= 0.6793,0.1646 [174.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 247.5679, l2 = 86.0653
INFO:root:Epoch    27 [863.4 s]
 validation= 0.6826,0.1663 [165.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 246.3825, l2 = 86.1403
INFO:root:Epoch    28 [865.4 s]
 validation= 0.6813,0.1656 [166.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 245.3703, l2 = 86.2371
INFO:root:Epoch    29 [817.7 s]
 validation= 0.6814,0.1653 [171.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 244.7006, l2 = 86.3537
INFO:root:Epoch    30 [824.7 s]
 validation= 0.6826,0.1657 [165.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 243.1165, l2 = 86.4221
INFO:root:Epoch    31 [821.3 s]
 validation= 0.6827,0.1660 [165.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 242.2668, l2 = 86.4611
INFO:root:Epoch    32 [799.5 s]
 validation= 0.6854,0.1665 [178.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 241.4849, l2 = 86.5256
INFO:root:Epoch    33 [800.9 s]
 validation= 0.6837,0.1663 [165.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 240.6630, l2 = 86.6299
INFO:root:Epoch    34 [797.9 s]
 validation= 0.6854,0.1669 [162.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 239.8250, l2 = 86.6849
INFO:root:Epoch    35 [793.2 s]
 validation= 0.6840,0.1661 [164.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 238.9711, l2 = 86.7433
INFO:root:Epoch    36 [796.7 s]
 validation= 0.6864,0.1677 [159.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 238.3981, l2 = 86.8215
INFO:root:Epoch    37 [790.0 s]
 validation= 0.6870,0.1676 [175.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 237.6672, l2 = 86.9450
INFO:root:Epoch    38 [802.9 s]
 validation= 0.6867,0.1672 [172.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.9304, l2 = 87.0438
INFO:root:Epoch    39 [820.2 s]
 validation= 0.6897,0.1684 [162.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 236.2960, l2 = 87.1415
INFO:root:Epoch    40 [755.5 s]
 validation= 0.6889,0.1682 [166.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.7967, l2 = 87.2252
INFO:root:Epoch    41 [706.2 s]
 validation= 0.6890,0.1678 [161.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.1203, l2 = 87.3088
INFO:root:Epoch    42 [721.1 s]
 validation= 0.6910,0.1689 [155.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 234.9615, l2 = 87.3761
INFO:root:Epoch    43 [704.3 s]
 validation= 0.6886,0.1674 [167.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.9632, l2 = 87.5087
INFO:root:Epoch    44 [708.7 s]
 validation= 0.6912,0.1681 [161.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 233.7602, l2 = 87.6478
INFO:root:Epoch    45 [709.0 s]
 validation= 0.6893,0.1681 [161.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.4674, l2 = 87.7662
INFO:root:Epoch    46 [757.6 s]
 validation= 0.6891,0.1678 [177.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.7856, l2 = 87.8322
INFO:root:Epoch    47 [739.9 s]
 validation= 0.6892,0.1685 [161.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.2670, l2 = 88.0003
INFO:root:Epoch    48 [717.0 s]
 validation= 0.6919,0.1696 [162.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 231.8710, l2 = 88.0443
INFO:root:Epoch    49 [718.5 s]
 validation= 0.6914,0.1687 [165.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.7381, l2 = 88.1431
INFO:root:Epoch    50 [720.0 s]
 validation= 0.6919,0.1689 [161.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.2963, l2 = 88.2601
INFO:root:Epoch    51 [717.5 s]
 validation= 0.6924,0.1692 [160.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 230.8065, l2 = 88.2965
INFO:root:Epoch    52 [743.3 s]
 validation= 0.6920,0.1690 [171.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.4638, l2 = 88.3123
INFO:root:Epoch    53 [738.4 s]
 validation= 0.6914,0.1687 [172.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.5285, l2 = 88.3747
INFO:root:Epoch    54 [719.7 s]
 validation= 0.6908,0.1691 [170.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.7958, l2 = 88.4456
INFO:root:Epoch    55 [720.5 s]
 validation= 0.6901,0.1685 [165.1 s] ndcg@10,f1@10
INFO:root:Early stop at 55 based on validation result.
INFO:root:Best Iter (validation) =    51	 valid= 0.6924,0.1692 [54985.1 s] ndcg@10,f1@10
INFO:root:Load model from ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Load model from ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_extraversion loss = 0.6984
INFO:root:Epoch     1 [2.2 s]
INFO:root:u_extraversion disc test = 0.5025,0.4574,0.3706,0.4574 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6948
INFO:root:

INFO:root:u_extraversion loss = 0.6454
INFO:root:Epoch   126 [2.9 s]
INFO:root:u_extraversion disc test = 0.5343,0.5466,0.5315,0.5466 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6122
INFO:root:Epoch   251 [2.2 s]
INFO:root:u_extraversion disc test = 0.5371,0.5488,0.5348,0.5488 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.5830
INFO:root:Epoch   376 [1.5 s]
INFO:root:u_extraversion disc test = 0.5265,0.5378,0.5244,0.5378 auc, acc, f1_macro, f1_micro
INFO:root:u_extraversion best auc: 0.5434
INFO:root:And the corresponding u_extraversion best disc test= 0.5434,0.5615,0.5345,0.5615 auc, acc, f1_macro, f1_micro
INFO:root:Load u_extraversion discriminator model from ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/u_extraversion_eval_disc.pt
INFO:root:Test After Training = 0.6937,0.1688 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 0.0015741809309507415
INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_AbsUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '3', 'verbose': 20, 'log_file': '../log/MLP_FOCF_AbsUnf__taobaoserendipity_u_extraversion__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_extraversion'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_AbsUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:numexpr.utils:Note: detected 96 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 96 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
INFO:numexpr.utils:NumExpr defaulting to 8 threads.
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 575.0576, l2 = 23.1963
INFO:root:Epoch     1 [1653.4 s]
 validation= 0.5478,0.1180 [400.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 464.4216, l2 = 43.9138
INFO:root:Epoch     2 [1389.7 s]
 validation= 0.5705,0.1262 [427.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 407.6567, l2 = 58.2926
INFO:root:Epoch     3 [1363.9 s]
 validation= 0.5905,0.1324 [280.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 370.8850, l2 = 67.2717
INFO:root:Epoch     4 [1399.3 s]
 validation= 0.6084,0.1384 [355.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 344.7702, l2 = 72.6094
INFO:root:Epoch     5 [1705.1 s]
 validation= 0.6227,0.1445 [254.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 325.3256, l2 = 75.8286
INFO:root:Epoch     6 [1875.3 s]
 validation= 0.6358,0.1498 [226.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 312.0203, l2 = 77.7360
INFO:root:Epoch     7 [1691.8 s]
 validation= 0.6425,0.1519 [308.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 302.3815, l2 = 78.9706
INFO:root:Epoch     8 [1707.3 s]
 validation= 0.6461,0.1534 [270.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 295.1603, l2 = 79.8594
INFO:root:Epoch     9 [1523.3 s]
 validation= 0.6512,0.1550 [362.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 289.5645, l2 = 80.5366
INFO:root:Epoch    10 [1542.5 s]
 validation= 0.6508,0.1550 [548.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 284.5961, l2 = 81.1034
INFO:root:Epoch    11 [1619.7 s]
 validation= 0.6560,0.1568 [418.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 280.5904, l2 = 81.6267
INFO:root:Epoch    12 [1378.4 s]
 validation= 0.6584,0.1579 [490.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 276.5281, l2 = 82.0747
INFO:root:Epoch    13 [1386.2 s]
 validation= 0.6588,0.1578 [281.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 273.5844, l2 = 82.5420
INFO:root:Epoch    14 [1412.2 s]
 validation= 0.6634,0.1593 [366.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 270.6390, l2 = 82.9907
INFO:root:Epoch    15 [1368.2 s]
 validation= 0.6638,0.1590 [304.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 267.9505, l2 = 83.4136
INFO:root:Epoch    16 [1407.5 s]
 validation= 0.6649,0.1597 [369.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 265.3144, l2 = 83.8438
INFO:root:Epoch    17 [1342.8 s]
 validation= 0.6687,0.1611 [263.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 263.0227, l2 = 84.1993
INFO:root:Epoch    18 [1363.2 s]
 validation= 0.6710,0.1620 [446.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 260.4742, l2 = 84.5613
INFO:root:Epoch    19 [1397.9 s]
 validation= 0.6703,0.1612 [344.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 258.3644, l2 = 84.8898
INFO:root:Epoch    20 [1285.9 s]
 validation= 0.6746,0.1630 [412.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 256.2623, l2 = 85.1997
INFO:root:Epoch    21 [1380.6 s]
 validation= 0.6733,0.1627 [340.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 254.6998, l2 = 85.5222
INFO:root:Epoch    22 [1320.9 s]
 validation= 0.6736,0.1631 [240.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 253.0427, l2 = 85.7935
INFO:root:Epoch    23 [1329.6 s]
 validation= 0.6758,0.1632 [334.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 251.0617, l2 = 85.9750
INFO:root:Epoch    24 [1427.0 s]
 validation= 0.6764,0.1633 [250.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 249.7064, l2 = 86.1613
INFO:root:Epoch    25 [1339.0 s]
 validation= 0.6788,0.1643 [368.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 248.0683, l2 = 86.3169
INFO:root:Epoch    26 [1152.5 s]
 validation= 0.6803,0.1647 [263.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 247.0150, l2 = 86.5055
INFO:root:Epoch    27 [1601.9 s]
 validation= 0.6824,0.1658 [319.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 245.5880, l2 = 86.7154
INFO:root:Epoch    28 [1662.5 s]
 validation= 0.6830,0.1658 [337.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 244.2362, l2 = 86.8853
INFO:root:Epoch    29 [1772.4 s]
 validation= 0.6838,0.1660 [325.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 243.5989, l2 = 87.0450
INFO:root:Epoch    30 [1799.0 s]
 validation= 0.6840,0.1665 [252.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 241.7862, l2 = 87.2037
INFO:root:Epoch    31 [1933.2 s]
 validation= 0.6844,0.1666 [447.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 241.1492, l2 = 87.2960
INFO:root:Epoch    32 [1762.1 s]
 validation= 0.6856,0.1667 [470.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.2205, l2 = 87.3701
INFO:root:Epoch    33 [1704.8 s]
 validation= 0.6854,0.1672 [499.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.2430, l2 = 87.4699
INFO:root:Epoch    34 [1767.6 s]
 validation= 0.6869,0.1676 [363.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 238.1649, l2 = 87.5346
INFO:root:Epoch    35 [1809.3 s]
 validation= 0.6857,0.1672 [443.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.3879, l2 = 87.5789
INFO:root:Epoch    36 [1681.3 s]
 validation= 0.6862,0.1671 [275.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.6178, l2 = 87.6450
INFO:root:Epoch    37 [1707.9 s]
 validation= 0.6890,0.1684 [331.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 236.0724, l2 = 87.6823
INFO:root:Epoch    38 [1490.5 s]
 validation= 0.6872,0.1674 [446.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.0307, l2 = 87.7845
INFO:root:Epoch    39 [1540.5 s]
 validation= 0.6895,0.1684 [464.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 234.3012, l2 = 87.8575
INFO:root:Epoch    40 [1645.4 s]
 validation= 0.6880,0.1677 [432.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.6431, l2 = 87.9117
INFO:root:Epoch    41 [1357.9 s]
 validation= 0.6901,0.1688 [187.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 233.1501, l2 = 87.9902
INFO:root:Epoch    42 [1331.3 s]
 validation= 0.6904,0.1687 [435.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 232.6936, l2 = 88.0964
INFO:root:Epoch    43 [1410.2 s]
 validation= 0.6906,0.1686 [292.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 231.7978, l2 = 88.1852
INFO:root:Epoch    44 [1065.8 s]
 validation= 0.6902,0.1687 [228.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.2103, l2 = 88.2636
INFO:root:Epoch    45 [1198.9 s]
 validation= 0.6907,0.1690 [259.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 231.0778, l2 = 88.3783
INFO:root:Epoch    46 [890.4 s]
 validation= 0.6914,0.1696 [183.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 230.3340, l2 = 88.4560
INFO:root:Epoch    47 [792.6 s]
 validation= 0.6913,0.1693 [205.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.7032, l2 = 88.5588
INFO:root:Epoch    48 [803.3 s]
 validation= 0.6906,0.1694 [184.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.4035, l2 = 88.6971
INFO:root:Epoch    49 [796.0 s]
 validation= 0.6910,0.1692 [155.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.8988, l2 = 88.7696
INFO:root:Epoch    50 [813.3 s]
 validation= 0.6927,0.1697 [187.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 228.6563, l2 = 88.8699
INFO:root:Epoch    51 [916.4 s]
 validation= 0.6905,0.1687 [236.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.4036, l2 = 88.8558
INFO:root:Epoch    52 [936.0 s]
 validation= 0.6920,0.1691 [240.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.0897, l2 = 88.9782
INFO:root:Epoch    53 [940.4 s]
 validation= 0.6929,0.1697 [193.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 227.3326, l2 = 88.9978
INFO:root:Epoch    54 [900.3 s]
 validation= 0.6925,0.1697 [290.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.2141, l2 = 89.0882
INFO:root:Epoch    55 [923.4 s]
 validation= 0.6933,0.1706 [225.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 226.8459, l2 = 89.0228
INFO:root:Epoch    56 [948.1 s]
 validation= 0.6924,0.1701 [192.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.4132, l2 = 89.0942
INFO:root:Epoch    57 [894.1 s]
 validation= 0.6952,0.1710 [221.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 225.9842, l2 = 89.1425
INFO:root:Epoch    58 [909.5 s]
 validation= 0.6946,0.1711 [216.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.1144, l2 = 89.1603
INFO:root:Epoch    59 [900.9 s]
 validation= 0.6959,0.1711 [203.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 225.6932, l2 = 89.2136
INFO:root:Epoch    60 [791.1 s]
 validation= 0.6926,0.1704 [198.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 225.3206, l2 = 89.1882
INFO:root:Epoch    61 [700.7 s]
 validation= 0.6934,0.1707 [171.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 224.9610, l2 = 89.1645
INFO:root:Epoch    62 [691.0 s]
 validation= 0.6912,0.1690 [172.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 224.6990, l2 = 89.2195
INFO:root:Epoch    63 [672.6 s]
 validation= 0.6938,0.1704 [173.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 224.3359, l2 = 89.3145
INFO:root:Epoch    64 [688.1 s]
 validation= 0.6938,0.1703 [172.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 224.2424, l2 = 89.3089
INFO:root:Epoch    65 [689.0 s]
 validation= 0.6964,0.1715 [169.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 223.8260, l2 = 89.3116
INFO:root:Epoch    66 [622.3 s]
 validation= 0.6933,0.1697 [136.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 223.6216, l2 = 89.3198
INFO:root:Epoch    67 [580.1 s]
 validation= 0.6917,0.1691 [135.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 223.5726, l2 = 89.3420
INFO:root:Epoch    68 [576.8 s]
 validation= 0.6918,0.1697 [133.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 223.2265, l2 = 89.3515
INFO:root:Epoch    69 [570.7 s]
 validation= 0.6940,0.1705 [134.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 222.8395, l2 = 89.3631
INFO:root:Epoch    70 [573.2 s]
 validation= 0.6935,0.1701 [134.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 223.2514, l2 = 89.4300
INFO:root:Epoch    71 [573.2 s]
 validation= 0.6920,0.1697 [132.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 223.0961, l2 = 89.4763
INFO:root:Epoch    72 [574.1 s]
 validation= 0.6951,0.1711 [132.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 222.7726, l2 = 89.5203
INFO:root:Epoch    73 [568.6 s]
 validation= 0.6959,0.1713 [133.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 222.1529, l2 = 89.4780
INFO:root:Epoch    74 [568.0 s]
 validation= 0.6954,0.1706 [132.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 222.1495, l2 = 89.5165
INFO:root:Epoch    75 [567.1 s]
 validation= 0.6957,0.1712 [135.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 222.0649, l2 = 89.5733
INFO:root:Epoch    76 [570.8 s]
 validation= 0.6949,0.1707 [136.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.9093, l2 = 89.6242
INFO:root:Epoch    77 [570.0 s]
 validation= 0.6949,0.1709 [135.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 222.0545, l2 = 89.6606
INFO:root:Epoch    78 [571.4 s]
 validation= 0.6962,0.1714 [132.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.3534, l2 = 89.6508
INFO:root:Epoch    79 [572.0 s]
 validation= 0.6945,0.1708 [134.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.5279, l2 = 89.6248
INFO:root:Epoch    80 [568.7 s]
 validation= 0.6963,0.1709 [133.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.3454, l2 = 89.7285
INFO:root:Epoch    81 [572.4 s]
 validation= 0.6931,0.1699 [134.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.6178, l2 = 89.8333
INFO:root:Epoch    82 [577.5 s]
 validation= 0.6972,0.1712 [134.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 221.1237, l2 = 89.8192
INFO:root:Epoch    83 [580.0 s]
 validation= 0.6948,0.1705 [137.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.3269, l2 = 89.8574
INFO:root:Epoch    84 [572.1 s]
 validation= 0.6960,0.1709 [133.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.8588, l2 = 89.8257
INFO:root:Epoch    85 [579.1 s]
 validation= 0.6936,0.1700 [132.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.6065, l2 = 89.7416
INFO:root:Epoch    86 [573.7 s]
 validation= 0.6969,0.1711 [134.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.4870, l2 = 89.7543
INFO:root:Epoch    87 [570.2 s]
 validation= 0.6954,0.1706 [134.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.5397, l2 = 89.6718
INFO:root:Epoch    88 [571.6 s]
 validation= 0.6938,0.1696 [131.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.1848, l2 = 89.6014
INFO:root:Epoch    89 [571.0 s]
 validation= 0.6958,0.1710 [134.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.8582, l2 = 89.5871
INFO:root:Epoch    90 [574.3 s]
 validation= 0.6946,0.1706 [138.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.2279, l2 = 89.6579
INFO:root:Epoch    91 [640.3 s]
 validation= 0.6929,0.1696 [144.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.8678, l2 = 89.6627
INFO:root:Epoch    92 [575.3 s]
 validation= 0.6950,0.1711 [134.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.9587, l2 = 89.6460
INFO:root:Epoch    93 [574.4 s]
 validation= 0.6952,0.1706 [136.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.4883, l2 = 89.6382
INFO:root:Epoch    94 [570.0 s]
 validation= 0.6966,0.1714 [131.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.5808, l2 = 89.5758
INFO:root:Epoch    95 [572.3 s]
 validation= 0.6959,0.1711 [132.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.5410, l2 = 89.5435
INFO:root:Epoch    96 [574.8 s]
 validation= 0.6943,0.1707 [133.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.3474, l2 = 89.5160
INFO:root:Epoch    97 [583.5 s]
 validation= 0.6948,0.1705 [153.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 219.2726, l2 = 89.5750
INFO:root:Epoch    98 [603.6 s]
 validation= 0.6972,0.1714 [135.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 218.9696, l2 = 89.5555
INFO:root:Epoch    99 [625.9 s]
 validation= 0.6964,0.1712 [131.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.8916, l2 = 89.5468
INFO:root:Epoch   100 [575.1 s]
 validation= 0.6952,0.1703 [158.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.9931, l2 = 89.5330
INFO:root:Epoch   101 [675.2 s]
 validation= 0.6953,0.1704 [138.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.8551, l2 = 89.5571
INFO:root:Epoch   102 [583.3 s]
 validation= 0.6930,0.1694 [133.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.9682, l2 = 89.5527
INFO:root:Epoch   103 [676.6 s]
 validation= 0.6956,0.1712 [172.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.7438, l2 = 89.5914
INFO:root:Epoch   104 [596.5 s]
 validation= 0.6940,0.1700 [133.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.2600, l2 = 89.5683
INFO:root:Epoch   105 [570.4 s]
 validation= 0.6986,0.1718 [132.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 218.5392, l2 = 89.5528
INFO:root:Epoch   106 [569.7 s]
 validation= 0.6950,0.1703 [132.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.4990, l2 = 89.5757
INFO:root:Epoch   107 [566.8 s]
 validation= 0.6951,0.1707 [133.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.9762, l2 = 89.5761
INFO:root:Epoch   108 [568.0 s]
 validation= 0.6982,0.1718 [132.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.6561, l2 = 89.6293
INFO:root:Epoch   109 [569.9 s]
 validation= 0.6963,0.1712 [131.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.4829, l2 = 89.5866
INFO:root:Epoch   110 [574.7 s]
 validation= 0.6976,0.1715 [133.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.0948, l2 = 89.6317
INFO:root:Epoch   111 [635.0 s]
 validation= 0.6989,0.1720 [164.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 218.3080, l2 = 89.5916
INFO:root:Epoch   112 [683.0 s]
 validation= 0.6963,0.1709 [176.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.1054, l2 = 89.6300
INFO:root:Epoch   113 [664.3 s]
 validation= 0.6950,0.1709 [168.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.9598, l2 = 89.5903
INFO:root:Epoch   114 [681.2 s]
 validation= 0.6971,0.1710 [148.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.9111, l2 = 89.6529
INFO:root:Epoch   115 [677.9 s]
 validation= 0.6951,0.1709 [171.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.1157, l2 = 89.7039
INFO:root:Epoch   116 [663.5 s]
 validation= 0.6961,0.1709 [166.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.8878, l2 = 89.6729
INFO:root:Epoch   117 [677.4 s]
 validation= 0.6992,0.1721 [173.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 217.6815, l2 = 89.6425
INFO:root:Epoch   118 [668.3 s]
 validation= 0.6968,0.1710 [164.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.7709, l2 = 89.6429
INFO:root:Epoch   119 [680.1 s]
 validation= 0.6949,0.1699 [131.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 218.0466, l2 = 89.7113
INFO:root:Epoch   120 [573.4 s]
 validation= 0.6947,0.1698 [132.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.3485, l2 = 89.6444
INFO:root:Epoch   121 [586.4 s]
 validation= 0.6973,0.1711 [137.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.8570, l2 = 89.6070
INFO:root:Epoch   122 [587.4 s]
 validation= 0.6961,0.1705 [139.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.6395, l2 = 89.6184
INFO:root:Epoch   123 [696.0 s]
 validation= 0.6946,0.1703 [165.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.3607, l2 = 89.6552
INFO:root:Epoch   124 [656.5 s]
 validation= 0.6958,0.1708 [164.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.3189, l2 = 89.6086
INFO:root:Epoch   125 [672.6 s]
 validation= 0.6921,0.1692 [163.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.2957, l2 = 89.5738
INFO:root:Epoch   126 [666.2 s]
 validation= 0.6930,0.1697 [164.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.4692, l2 = 89.5908
INFO:root:Epoch   127 [675.0 s]
 validation= 0.6959,0.1704 [147.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.0859, l2 = 89.5541
INFO:root:Epoch   128 [668.3 s]
 validation= 0.6970,0.1713 [163.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.9863, l2 = 89.5617
INFO:root:Epoch   129 [660.1 s]
 validation= 0.6952,0.1703 [163.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.3520, l2 = 89.5962
INFO:root:Epoch   130 [671.9 s]
 validation= 0.6942,0.1696 [163.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.9676, l2 = 89.5474
INFO:root:Epoch   131 [604.4 s]
 validation= 0.6986,0.1717 [131.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 217.1168, l2 = 89.5170
INFO:root:Epoch   132 [569.8 s]
 validation= 0.6937,0.1701 [133.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.7042, l2 = 89.5182
INFO:root:Epoch   133 [573.9 s]
 validation= 0.6975,0.1713 [132.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.7918, l2 = 89.4674
INFO:root:Epoch   134 [570.2 s]
 validation= 0.6972,0.1713 [132.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.7267, l2 = 89.5266
INFO:root:Epoch   135 [572.1 s]
 validation= 0.6959,0.1706 [132.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.5439, l2 = 89.4648
INFO:root:Epoch   136 [569.2 s]
 validation= 0.6949,0.1707 [136.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.8341, l2 = 89.5127
INFO:root:Epoch   137 [570.0 s]
 validation= 0.6977,0.1714 [134.0 s] ndcg@10,f1@10
INFO:root:Early stop at 137 based on validation result.
INFO:root:Best Iter (validation) =   117	 valid= 0.6992,0.1721 [158004.7 s] ndcg@10,f1@10
INFO:root:Load model from ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Load model from ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_extraversion loss = 0.6987
INFO:root:Epoch     1 [1.8 s]
INFO:root:u_extraversion disc test = 0.5047,0.4627,0.3659,0.4627 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6947
INFO:root:

INFO:root:u_extraversion loss = 0.6340
INFO:root:Epoch   126 [1.4 s]
INFO:root:u_extraversion disc test = 0.5490,0.5628,0.5451,0.5628 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6074
INFO:root:Epoch   251 [1.5 s]
INFO:root:u_extraversion disc test = 0.5446,0.5532,0.5440,0.5532 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.5810
INFO:root:Epoch   376 [1.4 s]
INFO:root:u_extraversion disc test = 0.5397,0.5496,0.5385,0.5496 auc, acc, f1_macro, f1_micro
INFO:root:u_extraversion best auc: 0.5556
INFO:root:And the corresponding u_extraversion best disc test= 0.5556,0.5677,0.5533,0.5677 auc, acc, f1_macro, f1_micro
INFO:root:Load u_extraversion discriminator model from ../model/MLP_FOCF_AbsUnf_taobaoserendipity_u_extraversion_neg_sample=1000/u_extraversion_eval_disc.pt
INFO:root:Test After Training = 0.7005,0.1714 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 0.004850657518130186

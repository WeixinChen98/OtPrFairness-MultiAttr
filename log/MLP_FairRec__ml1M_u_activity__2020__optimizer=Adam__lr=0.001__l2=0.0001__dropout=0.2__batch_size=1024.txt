INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FairRec', 'runner': 'RecRunner'}
INFO:root:{'gpu': '4', 'verbose': 20, 'log_file': '../log/MLP_FairRec__ml1M_u_activity__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'ml1M', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_activity'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.05, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FairRec
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 800169
INFO:root:load validation csv...
INFO:root:size of validation: 100020
INFO:root:load test csv...
INFO:root:size of test: 100020
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 668033
INFO:root:Optimizer: Adam
INFO:root:Optimizer: Adam
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 398.2245, l2 = 0.1550
INFO:root:u_activity disc test= 0.5044,0.8539,0.4697,0.8539auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5067,0.8541,0.4750,0.8541auc, acc, f1_macro, f1_micro
INFO:root:Epoch     1 [741.1 s]
 validation= 0.2294,0.1315 [255.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 342.9658, l2 = 0.1928
INFO:root:u_activity disc test= 0.5000,0.8529,0.4604,0.8529auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5009,0.8532,0.4622,0.8532auc, acc, f1_macro, f1_micro
INFO:root:Epoch     2 [688.2 s]
 validation= 0.2304,0.1328 [231.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 339.9633, l2 = 0.2280
INFO:root:u_activity disc test= 0.5001,0.8529,0.4605,0.8529auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5012,0.8532,0.4629,0.8532auc, acc, f1_macro, f1_micro
INFO:root:Epoch     3 [669.0 s]
 validation= 0.2304,0.1319 [152.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 337.3444, l2 = 0.2676
INFO:root:u_activity disc test= 0.5004,0.8530,0.4612,0.8530auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5005,0.8531,0.4614,0.8531auc, acc, f1_macro, f1_micro
INFO:root:Epoch     4 [631.0 s]
 validation= 0.2312,0.1320 [275.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 329.7409, l2 = 0.3176
INFO:root:u_activity disc test= 0.5001,0.8529,0.4606,0.8529auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5006,0.8531,0.4616,0.8531auc, acc, f1_macro, f1_micro
INFO:root:Epoch     5 [726.8 s]
 validation= 0.2411,0.1383 [301.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 309.4024, l2 = 0.3771
INFO:root:u_activity disc test= 0.5003,0.8530,0.4611,0.8530auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5003,0.8530,0.4611,0.8530auc, acc, f1_macro, f1_micro
INFO:root:Epoch     6 [696.3 s]
 validation= 0.2477,0.1409 [212.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 297.8360, l2 = 0.4335
INFO:root:u_activity disc test= 0.5002,0.8529,0.4609,0.8529auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5003,0.8530,0.4610,0.8530auc, acc, f1_macro, f1_micro
INFO:root:Epoch     7 [688.0 s]
 validation= 0.2517,0.1438 [225.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 294.3040, l2 = 0.4896
INFO:root:u_activity disc test= 0.5003,0.8530,0.4611,0.8530auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5005,0.8531,0.4615,0.8531auc, acc, f1_macro, f1_micro
INFO:root:Epoch     8 [738.3 s]
 validation= 0.2543,0.1457 [241.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 291.6325, l2 = 0.5478
INFO:root:u_activity disc test= 0.5002,0.8530,0.4607,0.8530auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5006,0.8531,0.4615,0.8531auc, acc, f1_macro, f1_micro
INFO:root:Epoch     9 [741.0 s]
 validation= 0.2559,0.1467 [328.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 287.7635, l2 = 0.6074
INFO:root:u_activity disc test= 0.5003,0.8530,0.4610,0.8530auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5004,0.8530,0.4611,0.8530auc, acc, f1_macro, f1_micro
INFO:root:Epoch    10 [763.2 s]
 validation= 0.2585,0.1491 [376.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 284.0979, l2 = 0.6696
INFO:root:u_activity disc test= 0.5019,0.8533,0.4646,0.8533auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5034,0.8536,0.4677,0.8536auc, acc, f1_macro, f1_micro
INFO:root:Epoch    11 [768.5 s]
 validation= 0.2609,0.1507 [276.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 279.0769, l2 = 0.7325
INFO:root:u_activity disc test= 0.5084,0.8545,0.4783,0.8545auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5177,0.8558,0.4976,0.8558auc, acc, f1_macro, f1_micro
INFO:root:Epoch    12 [740.8 s]
 validation= 0.2670,0.1548 [264.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 273.2043, l2 = 0.7989
INFO:root:u_activity disc test= 0.5220,0.8568,0.5058,0.8568auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5318,0.8588,0.5241,0.8588auc, acc, f1_macro, f1_micro
INFO:root:Epoch    13 [745.3 s]
 validation= 0.2763,0.1587 [389.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 267.4400, l2 = 0.8665
INFO:root:u_activity disc test= 0.5351,0.8593,0.5301,0.8593auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5486,0.8621,0.5535,0.8621auc, acc, f1_macro, f1_micro
INFO:root:Epoch    14 [743.7 s]
 validation= 0.2781,0.1597 [369.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 262.2586, l2 = 0.9335
INFO:root:u_activity disc test= 0.5486,0.8620,0.5535,0.8620auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5629,0.8651,0.5767,0.8651auc, acc, f1_macro, f1_micro
INFO:root:Epoch    15 [749.7 s]
 validation= 0.2797,0.1619 [339.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 256.8944, l2 = 1.0011
INFO:root:u_activity disc test= 0.5638,0.8651,0.5781,0.8651auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5768,0.8695,0.5980,0.8695auc, acc, f1_macro, f1_micro
INFO:root:Epoch    16 [759.4 s]
 validation= 0.2829,0.1638 [325.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 252.7933, l2 = 1.0676
INFO:root:u_activity disc test= 0.5716,0.8673,0.5901,0.8673auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5847,0.8705,0.6094,0.8705auc, acc, f1_macro, f1_micro
INFO:root:Epoch    17 [749.6 s]
 validation= 0.2852,0.1660 [439.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 246.9897, l2 = 1.1320
INFO:root:u_activity disc test= 0.5799,0.8695,0.6024,0.8695auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5814,0.8688,0.6044,0.8688auc, acc, f1_macro, f1_micro
INFO:root:Epoch    18 [770.2 s]
 validation= 0.2904,0.1690 [397.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 244.6733, l2 = 1.1978
INFO:root:u_activity disc test= 0.5872,0.8708,0.6128,0.8708auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5918,0.8714,0.6192,0.8714auc, acc, f1_macro, f1_micro
INFO:root:Epoch    19 [764.3 s]
 validation= 0.2939,0.1707 [259.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 241.7428, l2 = 1.2628
INFO:root:u_activity disc test= 0.5963,0.8738,0.6258,0.8738auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.5950,0.8718,0.6235,0.8718auc, acc, f1_macro, f1_micro
INFO:root:Epoch    20 [729.1 s]
 validation= 0.2946,0.1709 [447.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 239.2756, l2 = 1.3266
INFO:root:u_activity disc test= 0.6044,0.8749,0.6364,0.8749auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6056,0.8747,0.6378,0.8747auc, acc, f1_macro, f1_micro
INFO:root:Epoch    21 [770.0 s]
 validation= 0.2989,0.1737 [375.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 237.3609, l2 = 1.3893
INFO:root:u_activity disc test= 0.6077,0.8770,0.6416,0.8770auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6155,0.8776,0.6510,0.8776auc, acc, f1_macro, f1_micro
INFO:root:Epoch    22 [747.2 s]
 validation= 0.2992,0.1745 [362.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 235.3248, l2 = 1.4531
INFO:root:u_activity disc test= 0.6087,0.8760,0.6422,0.8760auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6234,0.8788,0.6605,0.8788auc, acc, f1_macro, f1_micro
INFO:root:Epoch    23 [776.2 s]
 validation= 0.2999,0.1749 [433.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 233.7069, l2 = 1.5158
INFO:root:u_activity disc test= 0.6216,0.8790,0.6587,0.8790auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6220,0.8781,0.6585,0.8781auc, acc, f1_macro, f1_micro
INFO:root:Epoch    24 [774.8 s]
 validation= 0.3046,0.1777 [322.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 231.9497, l2 = 1.5785
INFO:root:u_activity disc test= 0.6311,0.8813,0.6704,0.8813auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6241,0.8783,0.6609,0.8783auc, acc, f1_macro, f1_micro
INFO:root:Epoch    25 [760.7 s]
 validation= 0.3017,0.1766 [310.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.6422, l2 = 1.6440
INFO:root:u_activity disc test= 0.6368,0.8830,0.6774,0.8830auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6292,0.8800,0.6675,0.8800auc, acc, f1_macro, f1_micro
INFO:root:Epoch    26 [782.4 s]
 validation= 0.3030,0.1765 [351.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.6337, l2 = 1.7087
INFO:root:u_activity disc test= 0.6369,0.8822,0.6770,0.8822auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6341,0.8805,0.6729,0.8805auc, acc, f1_macro, f1_micro
INFO:root:Epoch    27 [776.3 s]
 validation= 0.3059,0.1793 [350.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 226.7307, l2 = 1.7718
INFO:root:u_activity disc test= 0.6413,0.8832,0.6821,0.8832auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6419,0.8827,0.6822,0.8827auc, acc, f1_macro, f1_micro
INFO:root:Epoch    28 [768.1 s]
 validation= 0.3086,0.1810 [336.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 225.9904, l2 = 1.8348
INFO:root:u_activity disc test= 0.6497,0.8854,0.6918,0.8854auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6486,0.8844,0.6900,0.8844auc, acc, f1_macro, f1_micro
INFO:root:Epoch    29 [754.9 s]
 validation= 0.3095,0.1804 [312.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 223.4752, l2 = 1.8967
INFO:root:u_activity disc test= 0.6552,0.8864,0.6978,0.8864auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6525,0.8854,0.6945,0.8854auc, acc, f1_macro, f1_micro
INFO:root:Epoch    30 [757.3 s]
 validation= 0.3083,0.1809 [335.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 221.8536, l2 = 1.9566
INFO:root:u_activity disc test= 0.6621,0.8892,0.7064,0.8892auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6572,0.8877,0.7007,0.8877auc, acc, f1_macro, f1_micro
INFO:root:Epoch    31 [749.1 s]
 validation= 0.3087,0.1808 [364.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 220.8084, l2 = 2.0176
INFO:root:u_activity disc test= 0.6702,0.8912,0.7151,0.8912auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6616,0.8894,0.7061,0.8894auc, acc, f1_macro, f1_micro
INFO:root:Epoch    32 [772.0 s]
 validation= 0.3102,0.1815 [481.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 218.8952, l2 = 2.0784
INFO:root:u_activity disc test= 0.6737,0.8920,0.7188,0.8920auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6734,0.8931,0.7196,0.8931auc, acc, f1_macro, f1_micro
INFO:root:Epoch    33 [759.5 s]
 validation= 0.3130,0.1830 [404.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 217.9925, l2 = 2.1376
INFO:root:u_activity disc test= 0.6824,0.8949,0.7286,0.8949auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6791,0.8944,0.7255,0.8944auc, acc, f1_macro, f1_micro
INFO:root:Epoch    34 [776.8 s]
 validation= 0.3159,0.1844 [303.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 218.2093, l2 = 2.1964
INFO:root:u_activity disc test= 0.6886,0.8968,0.7353,0.8968auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6832,0.8957,0.7301,0.8957auc, acc, f1_macro, f1_micro
INFO:root:Epoch    35 [763.9 s]
 validation= 0.3144,0.1847 [346.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 216.5178, l2 = 2.2554
INFO:root:u_activity disc test= 0.6936,0.8977,0.7400,0.8977auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6820,0.8950,0.7285,0.8950auc, acc, f1_macro, f1_micro
INFO:root:Epoch    36 [757.9 s]
 validation= 0.3173,0.1859 [353.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 215.3563, l2 = 2.3141
INFO:root:u_activity disc test= 0.6929,0.8976,0.7394,0.8976auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6803,0.8943,0.7264,0.8943auc, acc, f1_macro, f1_micro
INFO:root:Epoch    37 [773.5 s]
 validation= 0.3163,0.1853 [251.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 214.4067, l2 = 2.3701
INFO:root:u_activity disc test= 0.6968,0.8989,0.7437,0.8989auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6839,0.8954,0.7303,0.8954auc, acc, f1_macro, f1_micro
INFO:root:Epoch    38 [768.0 s]
 validation= 0.3170,0.1863 [342.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 213.9274, l2 = 2.4285
INFO:root:u_activity disc test= 0.6958,0.8980,0.7419,0.8980auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6856,0.8962,0.7324,0.8962auc, acc, f1_macro, f1_micro
INFO:root:Epoch    39 [778.4 s]
 validation= 0.3178,0.1865 [288.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 214.1177, l2 = 2.4848
INFO:root:u_activity disc test= 0.7045,0.9017,0.7522,0.9017auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6878,0.8972,0.7352,0.8972auc, acc, f1_macro, f1_micro
INFO:root:Epoch    40 [748.0 s]
 validation= 0.3177,0.1856 [365.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 212.1473, l2 = 2.5425
INFO:root:u_activity disc test= 0.7077,0.9028,0.7558,0.9028auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6886,0.8972,0.7357,0.8972auc, acc, f1_macro, f1_micro
INFO:root:Epoch    41 [769.3 s]
 validation= 0.3173,0.1861 [347.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 212.0896, l2 = 2.5990
INFO:root:u_activity disc test= 0.7136,0.9044,0.7615,0.9044auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6951,0.8990,0.7425,0.8990auc, acc, f1_macro, f1_micro
INFO:root:Epoch    42 [748.8 s]
 validation= 0.3213,0.1889 [356.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 209.5018, l2 = 2.6562
INFO:root:u_activity disc test= 0.7149,0.9050,0.7631,0.9050auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.6969,0.8992,0.7441,0.8992auc, acc, f1_macro, f1_micro
INFO:root:Epoch    43 [751.7 s]
 validation= 0.3187,0.1859 [330.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 209.4489, l2 = 2.7133
INFO:root:u_activity disc test= 0.7198,0.9059,0.7673,0.9059auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7013,0.9007,0.7490,0.9007auc, acc, f1_macro, f1_micro
INFO:root:Epoch    44 [763.7 s]
 validation= 0.3224,0.1897 [271.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 208.4406, l2 = 2.7701
INFO:root:u_activity disc test= 0.7216,0.9065,0.7692,0.9065auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7042,0.9015,0.7518,0.9015auc, acc, f1_macro, f1_micro
INFO:root:Epoch    45 [777.5 s]
 validation= 0.3204,0.1884 [298.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 207.9715, l2 = 2.8269
INFO:root:u_activity disc test= 0.7211,0.9062,0.7685,0.9062auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7073,0.9025,0.7551,0.9025auc, acc, f1_macro, f1_micro
INFO:root:Epoch    46 [779.6 s]
 validation= 0.3197,0.1878 [230.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 208.6281, l2 = 2.8835
INFO:root:u_activity disc test= 0.7216,0.9062,0.7688,0.9062auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7060,0.9018,0.7535,0.9018auc, acc, f1_macro, f1_micro
INFO:root:Epoch    47 [733.3 s]
 validation= 0.3232,0.1892 [282.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 207.4328, l2 = 2.9409
INFO:root:u_activity disc test= 0.7261,0.9087,0.7747,0.9087auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7114,0.9038,0.7593,0.9038auc, acc, f1_macro, f1_micro
INFO:root:Epoch    48 [744.2 s]
 validation= 0.3255,0.1912 [305.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 206.3770, l2 = 2.9964
INFO:root:u_activity disc test= 0.7276,0.9093,0.7764,0.9093auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7154,0.9051,0.7635,0.9051auc, acc, f1_macro, f1_micro
INFO:root:Epoch    49 [746.8 s]
 validation= 0.3241,0.1906 [211.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 205.1780, l2 = 3.0518
INFO:root:u_activity disc test= 0.7314,0.9099,0.7794,0.9099auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7135,0.9046,0.7617,0.9046auc, acc, f1_macro, f1_micro
INFO:root:Epoch    50 [735.3 s]
 validation= 0.3242,0.1901 [253.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 205.2700, l2 = 3.1075
INFO:root:u_activity disc test= 0.7371,0.9111,0.7842,0.9111auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7229,0.9078,0.7716,0.9078auc, acc, f1_macro, f1_micro
INFO:root:Epoch    51 [760.5 s]
 validation= 0.3238,0.1900 [360.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 204.3039, l2 = 3.1626
INFO:root:u_activity disc test= 0.7387,0.9119,0.7861,0.9119auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7236,0.9076,0.7718,0.9076auc, acc, f1_macro, f1_micro
INFO:root:Epoch    52 [724.5 s]
 validation= 0.3260,0.1912 [234.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 204.7476, l2 = 3.2154
INFO:root:u_activity disc test= 0.7414,0.9128,0.7889,0.9128auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7197,0.9066,0.7681,0.9066auc, acc, f1_macro, f1_micro
INFO:root:Epoch    53 [741.5 s]
 validation= 0.3279,0.1935 [245.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 203.0910, l2 = 3.2694
INFO:root:u_activity disc test= 0.7408,0.9130,0.7887,0.9130auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7210,0.9071,0.7695,0.9071auc, acc, f1_macro, f1_micro
INFO:root:Epoch    54 [732.5 s]
 validation= 0.3278,0.1936 [264.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 202.7158, l2 = 3.3221
INFO:root:u_activity disc test= 0.7450,0.9143,0.7928,0.9143auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7283,0.9094,0.7769,0.9094auc, acc, f1_macro, f1_micro
INFO:root:Epoch    55 [734.9 s]
 validation= 0.3285,0.1946 [238.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 202.4782, l2 = 3.3759
INFO:root:u_activity disc test= 0.7447,0.9144,0.7928,0.9144auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7301,0.9097,0.7783,0.9097auc, acc, f1_macro, f1_micro
INFO:root:Epoch    56 [721.9 s]
 validation= 0.3302,0.1945 [274.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 202.0676, l2 = 3.4317
INFO:root:u_activity disc test= 0.7473,0.9149,0.7949,0.9149auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7332,0.9108,0.7816,0.9108auc, acc, f1_macro, f1_micro
INFO:root:Epoch    57 [723.5 s]
 validation= 0.3274,0.1924 [178.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 201.0569, l2 = 3.4857
INFO:root:u_activity disc test= 0.7500,0.9162,0.7980,0.9162auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7362,0.9118,0.7847,0.9118auc, acc, f1_macro, f1_micro
INFO:root:Epoch    58 [719.4 s]
 validation= 0.3307,0.1951 [234.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 202.1548, l2 = 3.5412
INFO:root:u_activity disc test= 0.7516,0.9166,0.7994,0.9166auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7370,0.9118,0.7851,0.9118auc, acc, f1_macro, f1_micro
INFO:root:Epoch    59 [674.0 s]
 validation= 0.3276,0.1924 [231.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 200.0589, l2 = 3.5937
INFO:root:u_activity disc test= 0.7552,0.9176,0.8026,0.9176auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7400,0.9126,0.7878,0.9126auc, acc, f1_macro, f1_micro
INFO:root:Epoch    60 [710.1 s]
 validation= 0.3344,0.1970 [220.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 200.1476, l2 = 3.6479
INFO:root:u_activity disc test= 0.7590,0.9195,0.8072,0.9195auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7392,0.9121,0.7868,0.9121auc, acc, f1_macro, f1_micro
INFO:root:Epoch    61 [723.4 s]
 validation= 0.3310,0.1949 [272.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 200.8350, l2 = 3.6992
INFO:root:u_activity disc test= 0.7624,0.9206,0.8105,0.9206auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7488,0.9153,0.7962,0.9153auc, acc, f1_macro, f1_micro
INFO:root:Epoch    62 [706.7 s]
 validation= 0.3322,0.1964 [196.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 199.7891, l2 = 3.7517
INFO:root:u_activity disc test= 0.7623,0.9195,0.8089,0.9195auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7478,0.9155,0.7960,0.9155auc, acc, f1_macro, f1_micro
INFO:root:Epoch    63 [712.2 s]
 validation= 0.3280,0.1937 [227.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 199.7442, l2 = 3.8039
INFO:root:u_activity disc test= 0.7621,0.9194,0.8087,0.9194auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7508,0.9169,0.7994,0.9169auc, acc, f1_macro, f1_micro
INFO:root:Epoch    64 [711.4 s]
 validation= 0.3272,0.1937 [300.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 198.3556, l2 = 3.8566
INFO:root:u_activity disc test= 0.7628,0.9200,0.8098,0.9200auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7521,0.9171,0.8003,0.9171auc, acc, f1_macro, f1_micro
INFO:root:Epoch    65 [681.9 s]
 validation= 0.3301,0.1952 [206.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 198.9564, l2 = 3.9083
INFO:root:u_activity disc test= 0.7636,0.9197,0.8098,0.9197auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7544,0.9178,0.8025,0.9178auc, acc, f1_macro, f1_micro
INFO:root:Epoch    66 [719.4 s]
 validation= 0.3303,0.1956 [207.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 199.3293, l2 = 3.9611
INFO:root:u_activity disc test= 0.7638,0.9203,0.8108,0.9203auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7569,0.9180,0.8041,0.9180auc, acc, f1_macro, f1_micro
INFO:root:Epoch    67 [716.6 s]
 validation= 0.3351,0.1982 [305.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 198.2316, l2 = 4.0108
INFO:root:u_activity disc test= 0.7696,0.9225,0.8166,0.9225auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7599,0.9199,0.8082,0.9199auc, acc, f1_macro, f1_micro
INFO:root:Epoch    68 [712.8 s]
 validation= 0.3370,0.1989 [225.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 198.4570, l2 = 4.0644
INFO:root:u_activity disc test= 0.7703,0.9221,0.8164,0.9221auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7573,0.9192,0.8059,0.9192auc, acc, f1_macro, f1_micro
INFO:root:Epoch    69 [711.1 s]
 validation= 0.3321,0.1958 [251.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 196.7181, l2 = 4.1163
INFO:root:u_activity disc test= 0.7695,0.9219,0.8157,0.9219auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7611,0.9204,0.8095,0.9204auc, acc, f1_macro, f1_micro
INFO:root:Epoch    70 [679.1 s]
 validation= 0.3316,0.1956 [240.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 197.3810, l2 = 4.1646
INFO:root:u_activity disc test= 0.7733,0.9231,0.8192,0.9231auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7633,0.9213,0.8119,0.9213auc, acc, f1_macro, f1_micro
INFO:root:Epoch    71 [728.3 s]
 validation= 0.3378,0.1992 [211.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 197.4404, l2 = 4.2159
INFO:root:u_activity disc test= 0.7716,0.9221,0.8170,0.9221auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7591,0.9197,0.8075,0.9197auc, acc, f1_macro, f1_micro
INFO:root:Epoch    72 [713.5 s]
 validation= 0.3327,0.1957 [243.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 196.6432, l2 = 4.2670
INFO:root:u_activity disc test= 0.7801,0.9248,0.8248,0.9248auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7658,0.9220,0.8141,0.9220auc, acc, f1_macro, f1_micro
INFO:root:Epoch    73 [677.6 s]
 validation= 0.3360,0.1984 [219.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 195.5193, l2 = 4.3175
INFO:root:u_activity disc test= 0.7786,0.9247,0.8240,0.9247auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7667,0.9215,0.8138,0.9215auc, acc, f1_macro, f1_micro
INFO:root:Epoch    74 [700.4 s]
 validation= 0.3368,0.1981 [218.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 195.8869, l2 = 4.3677
INFO:root:u_activity disc test= 0.7838,0.9258,0.8278,0.9258auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7721,0.9234,0.8191,0.9234auc, acc, f1_macro, f1_micro
INFO:root:Epoch    75 [678.4 s]
 validation= 0.3345,0.1971 [180.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 195.8553, l2 = 4.4197
INFO:root:u_activity disc test= 0.7825,0.9253,0.8265,0.9253auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7687,0.9225,0.8162,0.9225auc, acc, f1_macro, f1_micro
INFO:root:Epoch    76 [682.7 s]
 validation= 0.3341,0.1963 [244.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 196.1358, l2 = 4.4682
INFO:root:u_activity disc test= 0.7849,0.9262,0.8288,0.9262auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7709,0.9229,0.8178,0.9229auc, acc, f1_macro, f1_micro
INFO:root:Epoch    77 [719.1 s]
 validation= 0.3335,0.1966 [232.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 195.5656, l2 = 4.5198
INFO:root:u_activity disc test= 0.7843,0.9266,0.8291,0.9266auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7728,0.9237,0.8198,0.9237auc, acc, f1_macro, f1_micro
INFO:root:Epoch    78 [682.0 s]
 validation= 0.3357,0.1974 [189.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 194.3125, l2 = 4.5674
INFO:root:u_activity disc test= 0.7847,0.9260,0.8284,0.9260auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7733,0.9233,0.8195,0.9233auc, acc, f1_macro, f1_micro
INFO:root:Epoch    79 [713.3 s]
 validation= 0.3344,0.1970 [278.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 194.1332, l2 = 4.6151
INFO:root:u_activity disc test= 0.7871,0.9274,0.8316,0.9274auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7722,0.9234,0.8191,0.9234auc, acc, f1_macro, f1_micro
INFO:root:Epoch    80 [705.7 s]
 validation= 0.3366,0.1981 [230.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 194.7515, l2 = 4.6670
INFO:root:u_activity disc test= 0.7891,0.9278,0.8330,0.9278auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7746,0.9238,0.8209,0.9238auc, acc, f1_macro, f1_micro
INFO:root:Epoch    81 [697.2 s]
 validation= 0.3356,0.1975 [235.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 195.2910, l2 = 4.7149
INFO:root:u_activity disc test= 0.7944,0.9298,0.8382,0.9298auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7784,0.9253,0.8246,0.9253auc, acc, f1_macro, f1_micro
INFO:root:Epoch    82 [693.8 s]
 validation= 0.3382,0.1986 [228.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 193.4017, l2 = 4.7660
INFO:root:u_activity disc test= 0.7976,0.9307,0.8407,0.9307auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7807,0.9267,0.8277,0.9267auc, acc, f1_macro, f1_micro
INFO:root:Epoch    83 [688.0 s]
 validation= 0.3380,0.1991 [195.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 193.2700, l2 = 4.8144
INFO:root:u_activity disc test= 0.7895,0.9279,0.8333,0.9279auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7814,0.9267,0.8280,0.9267auc, acc, f1_macro, f1_micro
INFO:root:Epoch    84 [684.4 s]
 validation= 0.3357,0.1970 [166.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 193.1519, l2 = 4.8636
INFO:root:u_activity disc test= 0.7898,0.9284,0.8342,0.9284auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7829,0.9268,0.8289,0.9268auc, acc, f1_macro, f1_micro
INFO:root:Epoch    85 [674.2 s]
 validation= 0.3349,0.1975 [183.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 192.8152, l2 = 4.9114
INFO:root:u_activity disc test= 0.7939,0.9292,0.8370,0.9292auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7874,0.9280,0.8325,0.9280auc, acc, f1_macro, f1_micro
INFO:root:Epoch    86 [657.7 s]
 validation= 0.3391,0.1990 [232.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:

INFO:root:loss = 193.1787, l2 = 4.9600
INFO:root:u_activity disc test= 0.7931,0.9289,0.8362,0.9289auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7885,0.9284,0.8336,0.9284auc, acc, f1_macro, f1_micro
INFO:root:Epoch    87 [699.4 s]
 validation= 0.3367,0.1979 [240.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 193.2125, l2 = 5.0080
INFO:root:u_activity disc test= 0.7962,0.9302,0.8395,0.9302auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7915,0.9297,0.8367,0.9297auc, acc, f1_macro, f1_micro
INFO:root:Epoch    88 [652.5 s]
 validation= 0.3344,0.1968 [236.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 194.0323, l2 = 5.0572
INFO:root:u_activity disc test= 0.7971,0.9297,0.8390,0.9297auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7912,0.9295,0.8364,0.9295auc, acc, f1_macro, f1_micro
INFO:root:Epoch    89 [683.2 s]
 validation= 0.3377,0.1989 [251.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 192.3901, l2 = 5.1047
INFO:root:u_activity disc test= 0.7971,0.9300,0.8394,0.9300auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7874,0.9282,0.8328,0.9282auc, acc, f1_macro, f1_micro
INFO:root:Epoch    90 [690.7 s]
 validation= 0.3316,0.1957 [229.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 193.0542, l2 = 5.1516
INFO:root:u_activity disc test= 0.7973,0.9301,0.8397,0.9301auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7916,0.9295,0.8366,0.9295auc, acc, f1_macro, f1_micro
INFO:root:Epoch    91 [663.0 s]
 validation= 0.3369,0.1989 [254.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 191.6449, l2 = 5.1976
INFO:root:u_activity disc test= 0.8018,0.9312,0.8431,0.9312auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7947,0.9305,0.8394,0.9305auc, acc, f1_macro, f1_micro
INFO:root:Epoch    92 [686.2 s]
 validation= 0.3316,0.1957 [252.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 191.3038, l2 = 5.2434
INFO:root:u_activity disc test= 0.8075,0.9327,0.8476,0.9327auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.7992,0.9315,0.8426,0.9315auc, acc, f1_macro, f1_micro
INFO:root:Epoch    93 [661.3 s]
 validation= 0.3352,0.1973 [187.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 190.9175, l2 = 5.2907
INFO:root:u_activity disc test= 0.8065,0.9326,0.8470,0.9326auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8019,0.9329,0.8457,0.9329auc, acc, f1_macro, f1_micro
INFO:root:Epoch    94 [635.5 s]
 validation= 0.3343,0.1968 [249.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 192.2346, l2 = 5.3352
INFO:root:u_activity disc test= 0.8079,0.9329,0.8480,0.9329auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8053,0.9337,0.8483,0.9337auc, acc, f1_macro, f1_micro
INFO:root:Epoch    95 [608.9 s]
 validation= 0.3365,0.1995 [176.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 190.9021, l2 = 5.3813
INFO:root:u_activity disc test= 0.8062,0.9324,0.8466,0.9324auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8063,0.9344,0.8498,0.9344auc, acc, f1_macro, f1_micro
INFO:root:Epoch    96 [647.8 s]
 validation= 0.3353,0.1984 [205.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 191.3963, l2 = 5.4276
INFO:root:u_activity disc test= 0.8102,0.9337,0.8500,0.9337auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8064,0.9345,0.8499,0.9345auc, acc, f1_macro, f1_micro
INFO:root:Epoch    97 [639.4 s]
 validation= 0.3346,0.1968 [196.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 191.1912, l2 = 5.4728
INFO:root:u_activity disc test= 0.8134,0.9353,0.8537,0.9353auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8110,0.9359,0.8538,0.9359auc, acc, f1_macro, f1_micro
INFO:root:Epoch    98 [654.1 s]
 validation= 0.3348,0.1963 [218.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 191.7848, l2 = 5.5193
INFO:root:u_activity disc test= 0.8170,0.9363,0.8565,0.9363auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8079,0.9347,0.8508,0.9347auc, acc, f1_macro, f1_micro
INFO:root:Epoch    99 [632.2 s]
 validation= 0.3378,0.1983 [257.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 191.0918, l2 = 5.5635
INFO:root:u_activity disc test= 0.8175,0.9364,0.8568,0.9364auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8138,0.9369,0.8563,0.9369auc, acc, f1_macro, f1_micro
INFO:root:Epoch   100 [642.0 s]
 validation= 0.3341,0.1972 [212.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 190.4911, l2 = 5.6079
INFO:root:u_activity disc test= 0.8160,0.9356,0.8551,0.9356auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8173,0.9381,0.8594,0.9381auc, acc, f1_macro, f1_micro
INFO:root:Epoch   101 [618.2 s]
 validation= 0.3367,0.1982 [195.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 190.8534, l2 = 5.6533
INFO:root:u_activity disc test= 0.8164,0.9365,0.8566,0.9365auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8171,0.9381,0.8593,0.9381auc, acc, f1_macro, f1_micro
INFO:root:Epoch   102 [621.7 s]
 validation= 0.3364,0.1981 [218.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 190.4918, l2 = 5.6978
INFO:root:u_activity disc test= 0.8152,0.9356,0.8548,0.9356auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8168,0.9377,0.8587,0.9377auc, acc, f1_macro, f1_micro
INFO:root:Epoch   103 [611.8 s]
 validation= 0.3352,0.1980 [178.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 190.4730, l2 = 5.7417
INFO:root:u_activity disc test= 0.8140,0.9349,0.8532,0.9349auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8158,0.9373,0.8577,0.9373auc, acc, f1_macro, f1_micro
INFO:root:Epoch   104 [612.7 s]
 validation= 0.3353,0.1967 [163.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 189.6744, l2 = 5.7864
INFO:root:u_activity disc test= 0.8144,0.9349,0.8534,0.9349auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8112,0.9357,0.8535,0.9357auc, acc, f1_macro, f1_micro
INFO:root:Epoch   105 [595.4 s]
 validation= 0.3343,0.1979 [188.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 189.7654, l2 = 5.8313
INFO:root:u_activity disc test= 0.8174,0.9360,0.8562,0.9360auc, acc, f1_macro, f1_micro
INFO:root:u_activity pred test= 0.8114,0.9355,0.8533,0.9355auc, acc, f1_macro, f1_micro
INFO:root:Epoch   106 [609.6 s]
 validation= 0.3354,0.1974 [188.4 s] ndcg@10,f1@10
INFO:root:Early stop at 106 based on validation result.
INFO:root:Best Iter (validation) =    86	 valid= 0.3391,0.1990 [104467.6 s] ndcg@10,f1@10
INFO:root:disc test: u_activity=0.7939auc, pred test: u_activity=0.7874auc
INFO:root:Load model from ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:Load u_activity discriminator model from ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/u_activity_disc.pt
INFO:root:Load u_activity discriminator model from ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/u_activity_disc.pt
INFO:root:Load model from ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/MLP_FairRec_ml1M_u_activity_l2=1e-4_dim=64_neg_samplev=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_activity loss = 0.6947
INFO:root:Epoch     1 [0.5 s]
INFO:root:u_activity disc test = 0.5000,0.4876,0.3278,0.4876 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_activity loss = 0.6917
INFO:root:

INFO:root:u_activity loss = 0.5375
INFO:root:Epoch   126 [0.9 s]
INFO:root:u_activity disc test = 0.5912,0.4056,0.3975,0.4056 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_activity loss = 0.4981
INFO:root:Epoch   251 [0.7 s]
INFO:root:u_activity disc test = 0.5704,0.4296,0.4296,0.4296 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_activity loss = 0.4655
INFO:root:Epoch   376 [0.4 s]
INFO:root:u_activity disc test = 0.5770,0.4238,0.4228,0.4238 auc, acc, f1_macro, f1_micro
INFO:root:u_activity best auc: 0.5996
INFO:root:And the corresponding u_activity best disc test= 0.5996,0.3982,0.3944,0.3982 auc, acc, f1_macro, f1_micro
INFO:root:Load u_activity discriminator model from ../model/MLP_FairRec_ml1M_u_activity_neg_samplev=1000/u_activity_eval_disc.pt
INFO:root:Test After Training = 0.3412,0.2027 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 0.22336535264682003

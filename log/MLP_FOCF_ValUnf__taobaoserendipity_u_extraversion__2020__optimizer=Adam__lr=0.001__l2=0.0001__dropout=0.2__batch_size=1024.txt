INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_ValUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '3', 'verbose': 20, 'log_file': '../log/MLP_FOCF_ValUnf__taobaoserendipity_u_extraversion__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_extraversion'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_ValUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 573.7693, l2 = 23.4513
INFO:root:Epoch     1 [883.9 s]
 validation= 0.5473,0.1179 [173.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 462.7797, l2 = 44.2598
INFO:root:Epoch     2 [916.0 s]
 validation= 0.5697,0.1260 [175.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 407.8016, l2 = 58.6869
INFO:root:Epoch     3 [889.6 s]
 validation= 0.5932,0.1334 [178.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 370.9264, l2 = 67.8234
INFO:root:Epoch     4 [891.5 s]
 validation= 0.6089,0.1388 [205.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 345.4177, l2 = 73.3966
INFO:root:Epoch     5 [914.1 s]
 validation= 0.6212,0.1440 [177.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 326.8279, l2 = 77.0549
INFO:root:Epoch     6 [913.1 s]
 validation= 0.6330,0.1486 [181.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 313.3947, l2 = 79.4545
INFO:root:Epoch     7 [916.3 s]
 validation= 0.6387,0.1503 [190.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 303.6961, l2 = 81.0159
INFO:root:Epoch     8 [903.5 s]
 validation= 0.6448,0.1526 [183.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 296.4446, l2 = 82.1730
INFO:root:Epoch     9 [900.4 s]
 validation= 0.6475,0.1535 [172.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 290.4052, l2 = 83.0625
INFO:root:Epoch    10 [884.1 s]
 validation= 0.6522,0.1554 [182.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 285.4301, l2 = 83.7779
INFO:root:Epoch    11 [893.6 s]
 validation= 0.6549,0.1563 [178.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 281.4933, l2 = 84.3167
INFO:root:Epoch    12 [894.2 s]
 validation= 0.6562,0.1570 [190.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 277.7873, l2 = 84.8099
INFO:root:Epoch    13 [910.6 s]
 validation= 0.6572,0.1569 [176.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 275.4635, l2 = 85.2897
INFO:root:Epoch    14 [910.1 s]
 validation= 0.6604,0.1582 [191.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 272.2240, l2 = 85.7277
INFO:root:Epoch    15 [891.4 s]
 validation= 0.6610,0.1583 [176.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 269.9353, l2 = 86.1431
INFO:root:Epoch    16 [875.0 s]
 validation= 0.6615,0.1588 [186.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 267.5473, l2 = 86.4970
INFO:root:Epoch    17 [883.5 s]
 validation= 0.6642,0.1590 [186.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 265.5455, l2 = 86.8017
INFO:root:Epoch    18 [891.7 s]
 validation= 0.6652,0.1593 [182.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 263.2847, l2 = 87.0673
INFO:root:Epoch    19 [889.8 s]
 validation= 0.6654,0.1602 [183.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 261.1171, l2 = 87.3305
INFO:root:Epoch    20 [900.4 s]
 validation= 0.6656,0.1599 [180.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 259.6176, l2 = 87.6078
INFO:root:Epoch    21 [895.6 s]
 validation= 0.6644,0.1597 [179.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 258.1591, l2 = 87.8900
INFO:root:Epoch    22 [901.2 s]
 validation= 0.6657,0.1601 [190.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 256.1724, l2 = 88.0966
INFO:root:Epoch    23 [923.0 s]
 validation= 0.6660,0.1604 [169.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 254.3579, l2 = 88.3205
INFO:root:Epoch    24 [889.6 s]
 validation= 0.6669,0.1609 [181.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 252.9278, l2 = 88.5762
INFO:root:Epoch    25 [878.0 s]
 validation= 0.6696,0.1616 [178.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 251.2670, l2 = 88.7792
INFO:root:Epoch    26 [870.4 s]
 validation= 0.6701,0.1620 [167.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 250.2527, l2 = 88.9885
INFO:root:Epoch    27 [865.0 s]
 validation= 0.6722,0.1629 [170.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 248.9261, l2 = 89.2240
INFO:root:Epoch    28 [884.6 s]
 validation= 0.6713,0.1626 [169.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 247.6835, l2 = 89.4175
INFO:root:Epoch    29 [825.1 s]
 validation= 0.6736,0.1630 [171.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 247.1815, l2 = 89.5205
INFO:root:Epoch    30 [821.9 s]
 validation= 0.6724,0.1625 [167.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 245.5637, l2 = 89.5945
INFO:root:Epoch    31 [831.2 s]
 validation= 0.6745,0.1636 [168.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 244.9263, l2 = 89.7458
INFO:root:Epoch    32 [810.9 s]
 validation= 0.6744,0.1636 [173.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 244.2557, l2 = 89.8697
INFO:root:Epoch    33 [803.9 s]
 validation= 0.6738,0.1634 [169.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 243.5213, l2 = 89.9848
INFO:root:Epoch    34 [791.0 s]
 validation= 0.6749,0.1639 [164.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 242.7103, l2 = 90.0635
INFO:root:Epoch    35 [811.1 s]
 validation= 0.6755,0.1640 [167.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 241.9816, l2 = 90.1237
INFO:root:Epoch    36 [816.6 s]
 validation= 0.6757,0.1642 [167.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 241.4215, l2 = 90.2532
INFO:root:Epoch    37 [814.1 s]
 validation= 0.6774,0.1641 [158.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.9330, l2 = 90.4523
INFO:root:Epoch    38 [833.7 s]
 validation= 0.6778,0.1647 [159.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.4574, l2 = 90.6062
INFO:root:Epoch    39 [830.3 s]
 validation= 0.6762,0.1646 [157.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.5092, l2 = 90.6330
INFO:root:Epoch    40 [726.4 s]
 validation= 0.6754,0.1639 [169.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 238.8444, l2 = 90.7010
INFO:root:Epoch    41 [714.2 s]
 validation= 0.6784,0.1653 [160.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 238.5360, l2 = 90.8518
INFO:root:Epoch    42 [708.2 s]
 validation= 0.6783,0.1648 [160.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 238.6773, l2 = 90.9272
INFO:root:Epoch    43 [720.5 s]
 validation= 0.6772,0.1649 [155.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.6241, l2 = 91.0343
INFO:root:Epoch    44 [708.8 s]
 validation= 0.6798,0.1663 [155.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 236.8719, l2 = 91.1355
INFO:root:Epoch    45 [721.6 s]
 validation= 0.6784,0.1649 [157.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.0424, l2 = 91.2232
INFO:root:Epoch    46 [754.7 s]
 validation= 0.6791,0.1652 [158.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.4515, l2 = 91.3614
INFO:root:Epoch    47 [713.3 s]
 validation= 0.6793,0.1652 [163.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.0136, l2 = 91.4738
INFO:root:Epoch    48 [708.5 s]
 validation= 0.6801,0.1655 [162.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 235.6463, l2 = 91.5772
INFO:root:Epoch    49 [714.2 s]
 validation= 0.6810,0.1658 [176.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 235.0376, l2 = 91.6953
INFO:root:Epoch    50 [713.4 s]
 validation= 0.6799,0.1650 [166.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.1749, l2 = 91.8184
INFO:root:Epoch    51 [711.4 s]
 validation= 0.6808,0.1656 [170.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 234.8779, l2 = 91.9302
INFO:root:Epoch    52 [741.1 s]
 validation= 0.6814,0.1659 [153.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 234.4659, l2 = 92.0461
INFO:root:Epoch    53 [739.8 s]
 validation= 0.6815,0.1656 [160.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 233.8944, l2 = 92.1910
INFO:root:Epoch    54 [723.5 s]
 validation= 0.6807,0.1658 [161.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.8924, l2 = 92.2642
INFO:root:Epoch    55 [719.6 s]
 validation= 0.6824,0.1659 [160.9 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 233.5267, l2 = 92.3305
INFO:root:Epoch    56 [691.0 s]
 validation= 0.6801,0.1654 [156.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.1169, l2 = 92.4239
INFO:root:Epoch    57 [687.0 s]
 validation= 0.6826,0.1661 [160.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 232.6836, l2 = 92.4969
INFO:root:Epoch    58 [698.7 s]
 validation= 0.6808,0.1658 [158.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.6514, l2 = 92.5677
INFO:root:Epoch    59 [697.4 s]
 validation= 0.6816,0.1659 [161.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.2742, l2 = 92.6026
INFO:root:Epoch    60 [693.5 s]
 validation= 0.6815,0.1663 [156.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.1187, l2 = 92.6833
INFO:root:Epoch    61 [697.5 s]
 validation= 0.6810,0.1656 [160.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.5744, l2 = 92.6894
INFO:root:Epoch    62 [692.3 s]
 validation= 0.6814,0.1654 [155.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.3343, l2 = 92.8086
INFO:root:Epoch    63 [693.1 s]
 validation= 0.6819,0.1661 [159.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.3625, l2 = 92.8504
INFO:root:Epoch    64 [704.4 s]
 validation= 0.6824,0.1666 [159.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.0154, l2 = 92.8282
INFO:root:Epoch    65 [691.9 s]
 validation= 0.6834,0.1668 [169.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 230.7277, l2 = 92.9430
INFO:root:Epoch    66 [692.3 s]
 validation= 0.6816,0.1663 [160.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.5085, l2 = 92.9423
INFO:root:Epoch    67 [675.9 s]
 validation= 0.6822,0.1661 [162.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.0674, l2 = 92.9582
INFO:root:Epoch    68 [681.5 s]
 validation= 0.6789,0.1648 [162.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.8650, l2 = 93.0425
INFO:root:Epoch    69 [692.8 s]
 validation= 0.6828,0.1662 [159.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.8153, l2 = 93.1044
INFO:root:Epoch    70 [695.8 s]
 validation= 0.6835,0.1662 [161.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 229.6995, l2 = 93.1065
INFO:root:Epoch    71 [691.8 s]
 validation= 0.6826,0.1658 [154.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.5691, l2 = 93.1303
INFO:root:Epoch    72 [681.1 s]
 validation= 0.6822,0.1661 [166.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.4131, l2 = 93.2185
INFO:root:Epoch    73 [677.9 s]
 validation= 0.6834,0.1662 [161.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.9255, l2 = 93.1779
INFO:root:Epoch    74 [690.8 s]
 validation= 0.6828,0.1662 [162.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.5948, l2 = 93.2008
INFO:root:Epoch    75 [679.3 s]
 validation= 0.6832,0.1662 [156.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.5621, l2 = 93.2225
INFO:root:Epoch    76 [678.3 s]
 validation= 0.6837,0.1668 [168.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 228.6276, l2 = 93.3014
INFO:root:Epoch    77 [672.0 s]
 validation= 0.6838,0.1665 [166.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 228.5611, l2 = 93.3823
INFO:root:Epoch    78 [686.0 s]
 validation= 0.6836,0.1666 [152.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.9608, l2 = 93.4323
INFO:root:Epoch    79 [689.7 s]
 validation= 0.6817,0.1655 [160.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.1153, l2 = 93.3914
INFO:root:Epoch    80 [686.2 s]
 validation= 0.6821,0.1663 [161.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.8179, l2 = 93.4693
INFO:root:Epoch    81 [682.6 s]
 validation= 0.6824,0.1660 [157.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 228.0991, l2 = 93.5275
INFO:root:Epoch    82 [686.2 s]
 validation= 0.6831,0.1664 [158.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.8204, l2 = 93.5907
INFO:root:Epoch    83 [679.7 s]
 validation= 0.6836,0.1666 [155.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.3988, l2 = 93.5328
INFO:root:Epoch    84 [702.5 s]
 validation= 0.6853,0.1673 [164.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 227.2070, l2 = 93.5372
INFO:root:Epoch    85 [706.4 s]
 validation= 0.6835,0.1668 [168.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.2910, l2 = 93.4737
INFO:root:Epoch    86 [688.6 s]
 validation= 0.6832,0.1665 [158.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.7466, l2 = 93.5628
INFO:root:Epoch    87 [698.1 s]
 validation= 0.6797,0.1655 [168.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 227.0147, l2 = 93.5428
INFO:root:Epoch    88 [696.2 s]
 validation= 0.6828,0.1660 [158.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.7774, l2 = 93.5951
INFO:root:Epoch    89 [687.8 s]
 validation= 0.6816,0.1656 [160.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.5314, l2 = 93.5638
INFO:root:Epoch    90 [699.3 s]
 validation= 0.6837,0.1666 [156.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.5842, l2 = 93.6232
INFO:root:Epoch    91 [705.7 s]
 validation= 0.6833,0.1668 [159.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.1435, l2 = 93.6819
INFO:root:Epoch    92 [694.1 s]
 validation= 0.6839,0.1665 [178.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.2663, l2 = 93.6604
INFO:root:Epoch    93 [701.4 s]
 validation= 0.6848,0.1666 [157.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 226.1280, l2 = 93.6483
INFO:root:Epoch    94 [700.5 s]
 validation= 0.6855,0.1668 [160.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 225.7431, l2 = 93.6390
INFO:root:Epoch    95 [697.6 s]
 validation= 0.6855,0.1675 [156.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 225.8965, l2 = 93.6026
INFO:root:Epoch    96 [703.7 s]
 validation= 0.6857,0.1671 [166.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 225.8226, l2 = 93.6489
INFO:root:Epoch    97 [710.8 s]
 validation= 0.6848,0.1666 [156.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 225.6312, l2 = 93.7562
INFO:root:Epoch    98 [702.4 s]
 validation= 0.6836,0.1664 [157.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 225.4555, l2 = 93.7741
INFO:root:Epoch    99 [699.9 s]
 validation= 0.6826,0.1660 [171.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 225.0449, l2 = 93.7701
INFO:root:Epoch   100 [699.5 s]
 validation= 0.6817,0.1662 [159.4 s] ndcg@10,f1@10
INFO:root:Early stop at 100 based on validation result.
INFO:root:Best Iter (validation) =    96	 valid= 0.6857,0.1671 [93518.4 s] ndcg@10,f1@10
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_extraversion loss = 0.6974
INFO:root:Epoch     1 [1.9 s]
INFO:root:u_extraversion disc test = 0.5034,0.4613,0.3641,0.4613 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6942
INFO:root:

INFO:root:u_extraversion loss = 0.6416
INFO:root:Epoch   126 [1.6 s]
INFO:root:u_extraversion disc test = 0.5193,0.5343,0.5135,0.5343 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6046
INFO:root:Epoch   251 [1.6 s]
INFO:root:u_extraversion disc test = 0.5241,0.5365,0.5210,0.5365 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.5808
INFO:root:Epoch   376 [1.7 s]
INFO:root:u_extraversion disc test = 0.5094,0.5246,0.5032,0.5246 auc, acc, f1_macro, f1_micro
INFO:root:u_extraversion best auc: 0.5277
INFO:root:And the corresponding u_extraversion best disc test= 0.5277,0.5439,0.5208,0.5439 auc, acc, f1_macro, f1_micro
INFO:root:Load u_extraversion discriminator model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/u_extraversion_eval_disc.pt
INFO:root:Test After Training = 0.6878,0.1667 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 0.003292205394494041
INFO:root:{'data_reader': 'RecDataReader', 'data_processor': 'RecDataset', 'model_name': 'MLP', 'fairness_framework': 'FOCF_ValUnf', 'runner': 'RecRunner'}
INFO:root:{'gpu': '3', 'verbose': 20, 'log_file': '../log/MLP_FOCF_ValUnf__taobaoserendipity_u_extraversion__2020__optimizer=Adam__lr=0.001__l2=0.0001__dropout=0.2__batch_size=1024.txt', 'result_file': '../result/result.npy', 'random_seed': 2020, 'train': 1, 'path': '../dataset/', 'dataset': 'taobaoserendipity', 'sep': '\t', 'label': 'label', 'feature_columns': ['u_extraversion'], 'neg_slope': 0.2, 'attacker_layers': 3, 'discriminator_layers': 3, 'predictor_layers': 3, 'num_layers': 3, 'model_path': '../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt', 'u_vector_size': 64, 'i_vector_size': 64, 'load': 0, 'load_attack': False, 'epoch': 1000, 'disc_epoch': 500, 'check_epoch': 1, 'early_stop': 1, 'lr': 0.001, 'lr_attack': 0.001, 'batch_size': 1024, 'vt_batch_size': 1024, 'dropout': 0.2, 'l2': 0.0001, 'l2_attack': 0.0001, 'optimizer': 'Adam', 'metric': 'ndcg@10,f1@10', 'disc_metric': 'auc,acc,f1_macro,f1_micro', 'skip_eval': 0, 'num_worker': 0, 'eval_disc': True, 'fairrec_lambda': 0.5, 'train_num_neg': 1, 'vt_num_neg': 1000, 'disc_batch_size': 7000}
INFO:root:DataReader: RecDataReader
INFO:root:Model: MLP
INFO:root:Fairness framework: FOCF_ValUnf
INFO:root:Runner: RecRunner
INFO:root:DataProcessor: RecDataset
INFO:root:# cuda devices: 1
INFO:root:load all csv...
INFO:root:load train csv...
INFO:root:size of train: 9132376
INFO:root:load validation csv...
INFO:root:size of validation: 1141547
INFO:root:load test csv...
INFO:root:size of test: 1141548
INFO:root:Load validation data from pickle file.
INFO:root:Load test data from pickle file.
INFO:root:# of params: 54133185
INFO:numexpr.utils:Note: detected 96 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
INFO:numexpr.utils:Note: NumExpr detected 96 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
INFO:numexpr.utils:NumExpr defaulting to 8 threads.
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:loss = 572.8288, l2 = 23.5906
INFO:root:Epoch     1 [1403.8 s]
 validation= 0.5483,0.1183 [303.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 462.2453, l2 = 44.4987
INFO:root:Epoch     2 [1298.3 s]
 validation= 0.5700,0.1260 [348.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 407.5080, l2 = 59.0101
INFO:root:Epoch     3 [1218.4 s]
 validation= 0.5922,0.1330 [313.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 372.5167, l2 = 68.1071
INFO:root:Epoch     4 [1213.9 s]
 validation= 0.6069,0.1380 [272.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 349.6779, l2 = 73.6095
INFO:root:Epoch     5 [1268.3 s]
 validation= 0.6182,0.1423 [321.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 332.4150, l2 = 77.0843
INFO:root:Epoch     6 [1121.3 s]
 validation= 0.6285,0.1464 [234.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 318.7271, l2 = 79.2802
INFO:root:Epoch     7 [1030.7 s]
 validation= 0.6346,0.1492 [278.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 308.1087, l2 = 80.8131
INFO:root:Epoch     8 [1121.0 s]
 validation= 0.6421,0.1519 [342.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 299.5535, l2 = 81.9329
INFO:root:Epoch     9 [980.8 s]
 validation= 0.6448,0.1526 [264.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 292.3930, l2 = 82.8083
INFO:root:Epoch    10 [1100.4 s]
 validation= 0.6485,0.1544 [232.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 286.5719, l2 = 83.5530
INFO:root:Epoch    11 [1300.0 s]
 validation= 0.6530,0.1561 [217.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 281.9522, l2 = 84.2119
INFO:root:Epoch    12 [1145.6 s]
 validation= 0.6572,0.1568 [349.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 277.4480, l2 = 84.8371
INFO:root:Epoch    13 [1220.5 s]
 validation= 0.6600,0.1580 [358.1 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 274.3173, l2 = 85.4006
INFO:root:Epoch    14 [1158.4 s]
 validation= 0.6617,0.1586 [241.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 271.1339, l2 = 85.8706
INFO:root:Epoch    15 [1227.3 s]
 validation= 0.6646,0.1592 [348.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 268.1638, l2 = 86.2991
INFO:root:Epoch    16 [1228.1 s]
 validation= 0.6639,0.1601 [370.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 265.5599, l2 = 86.5836
INFO:root:Epoch    17 [1193.8 s]
 validation= 0.6672,0.1606 [311.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 263.4315, l2 = 86.9201
INFO:root:Epoch    18 [1174.6 s]
 validation= 0.6682,0.1610 [298.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 261.0638, l2 = 87.2504
INFO:root:Epoch    19 [1303.0 s]
 validation= 0.6679,0.1608 [321.6 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 258.9644, l2 = 87.4814
INFO:root:Epoch    20 [1158.3 s]
 validation= 0.6709,0.1615 [399.8 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 257.3188, l2 = 87.7294
INFO:root:Epoch    21 [1274.0 s]
 validation= 0.6721,0.1624 [302.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 255.8177, l2 = 87.9391
INFO:root:Epoch    22 [1355.0 s]
 validation= 0.6708,0.1615 [213.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 254.2093, l2 = 88.0953
INFO:root:Epoch    23 [1269.5 s]
 validation= 0.6708,0.1614 [375.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 252.3282, l2 = 88.2444
INFO:root:Epoch    24 [1138.3 s]
 validation= 0.6756,0.1628 [378.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 250.9621, l2 = 88.4397
INFO:root:Epoch    25 [1168.5 s]
 validation= 0.6729,0.1625 [219.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 249.7515, l2 = 88.5856
INFO:root:Epoch    26 [1138.3 s]
 validation= 0.6734,0.1623 [250.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 248.6952, l2 = 88.7962
INFO:root:Epoch    27 [1157.8 s]
 validation= 0.6755,0.1632 [339.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 247.5038, l2 = 88.9786
INFO:root:Epoch    28 [1069.2 s]
 validation= 0.6762,0.1634 [301.4 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 246.6825, l2 = 89.1569
INFO:root:Epoch    29 [1091.5 s]
 validation= 0.6759,0.1633 [331.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 245.8470, l2 = 89.2578
INFO:root:Epoch    30 [1301.6 s]
 validation= 0.6751,0.1629 [216.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 244.2459, l2 = 89.3415
INFO:root:Epoch    31 [1169.0 s]
 validation= 0.6768,0.1634 [290.5 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 243.5443, l2 = 89.4249
INFO:root:Epoch    32 [1455.6 s]
 validation= 0.6781,0.1640 [271.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 243.1047, l2 = 89.5833
INFO:root:Epoch    33 [1449.4 s]
 validation= 0.6752,0.1630 [241.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 242.5939, l2 = 89.8191
INFO:root:Epoch    34 [1548.9 s]
 validation= 0.6743,0.1628 [225.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 241.4939, l2 = 89.8817
INFO:root:Epoch    35 [1384.0 s]
 validation= 0.6787,0.1642 [230.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 240.7027, l2 = 89.9808
INFO:root:Epoch    36 [1277.8 s]
 validation= 0.6774,0.1638 [223.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 240.0498, l2 = 90.0946
INFO:root:Epoch    37 [1271.5 s]
 validation= 0.6780,0.1642 [289.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 239.6008, l2 = 90.2295
INFO:root:Epoch    38 [1297.8 s]
 validation= 0.6793,0.1648 [270.3 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 239.0687, l2 = 90.3097
INFO:root:Epoch    39 [1698.7 s]
 validation= 0.6797,0.1644 [328.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 238.0859, l2 = 90.2976
INFO:root:Epoch    40 [1450.0 s]
 validation= 0.6784,0.1646 [375.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.6828, l2 = 90.4184
INFO:root:Epoch    41 [1740.8 s]
 validation= 0.6817,0.1657 [436.6 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 237.6005, l2 = 90.5629
INFO:root:Epoch    42 [1689.8 s]
 validation= 0.6816,0.1650 [372.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 237.0744, l2 = 90.7049
INFO:root:Epoch    43 [1843.6 s]
 validation= 0.6788,0.1644 [294.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 236.5398, l2 = 90.7841
INFO:root:Epoch    44 [1658.1 s]
 validation= 0.6831,0.1658 [440.2 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 235.9919, l2 = 90.8395
INFO:root:Epoch    45 [1624.9 s]
 validation= 0.6813,0.1650 [314.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.6079, l2 = 90.9964
INFO:root:Epoch    46 [1727.0 s]
 validation= 0.6805,0.1651 [284.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 235.2403, l2 = 91.0887
INFO:root:Epoch    47 [1448.2 s]
 validation= 0.6809,0.1653 [230.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 234.9280, l2 = 91.2151
INFO:root:Epoch    48 [1008.8 s]
 validation= 0.6802,0.1645 [207.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 234.1866, l2 = 91.3276
INFO:root:Epoch    49 [1190.7 s]
 validation= 0.6815,0.1651 [218.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.7933, l2 = 91.3887
INFO:root:Epoch    50 [986.4 s]
 validation= 0.6773,0.1640 [175.9 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.8458, l2 = 91.4915
INFO:root:Epoch    51 [1013.1 s]
 validation= 0.6795,0.1643 [219.5 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.3391, l2 = 91.6102
INFO:root:Epoch    52 [807.2 s]
 validation= 0.6812,0.1646 [154.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 233.0529, l2 = 91.6935
INFO:root:Epoch    53 [794.2 s]
 validation= 0.6831,0.1656 [211.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 232.6657, l2 = 91.7703
INFO:root:Epoch    54 [828.1 s]
 validation= 0.6851,0.1664 [222.7 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 232.7640, l2 = 91.8193
INFO:root:Epoch    55 [846.1 s]
 validation= 0.6822,0.1655 [183.8 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.8888, l2 = 91.9033
INFO:root:Epoch    56 [781.4 s]
 validation= 0.6825,0.1660 [178.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.9162, l2 = 92.0311
INFO:root:Epoch    57 [771.1 s]
 validation= 0.6814,0.1657 [221.3 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.6792, l2 = 92.0316
INFO:root:Epoch    58 [767.5 s]
 validation= 0.6859,0.1669 [173.0 s] ndcg@10,f1@10
INFO:root:Save model to ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:

INFO:root:loss = 231.3190, l2 = 92.0518
INFO:root:Epoch    59 [839.9 s]
 validation= 0.6819,0.1654 [190.1 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 231.0175, l2 = 92.1552
INFO:root:Epoch    60 [876.0 s]
 validation= 0.6855,0.1672 [230.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.4863, l2 = 92.1719
INFO:root:Epoch    61 [912.0 s]
 validation= 0.6858,0.1674 [202.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.2004, l2 = 92.1413
INFO:root:Epoch    62 [835.5 s]
 validation= 0.6828,0.1656 [226.7 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 230.2018, l2 = 92.1729
INFO:root:Epoch    63 [788.3 s]
 validation= 0.6849,0.1665 [238.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.5155, l2 = 92.1276
INFO:root:Epoch    64 [850.5 s]
 validation= 0.6830,0.1657 [205.4 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.4492, l2 = 92.1681
INFO:root:Epoch    65 [861.0 s]
 validation= 0.6822,0.1658 [184.0 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.2558, l2 = 92.2411
INFO:root:Epoch    66 [841.0 s]
 validation= 0.6812,0.1646 [206.2 s] ndcg@10,f1@10
INFO:root:

INFO:root:loss = 229.0239, l2 = 92.3640
INFO:root:Epoch    67 [878.4 s]
 validation= 0.6810,0.1653 [272.1 s] ndcg@10,f1@10
INFO:root:Early stop at 67 based on validation result.
INFO:root:Best Iter (validation) =    58	 valid= 0.6859,0.1669 [97369.0 s] ndcg@10,f1@10
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Load model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_l2=1e-4_dim=64_neg_sample=1000.pt
INFO:root:Optimizer: Adam
INFO:root:

INFO:root:u_extraversion loss = 0.6977
INFO:root:Epoch     1 [2.8 s]
INFO:root:u_extraversion disc test = 0.5070,0.4653,0.3711,0.4653 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6938
INFO:root:

INFO:root:u_extraversion loss = 0.6430
INFO:root:Epoch   126 [1.9 s]
INFO:root:u_extraversion disc test = 0.5167,0.5286,0.5139,0.5286 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.6059
INFO:root:Epoch   251 [2.2 s]
INFO:root:u_extraversion disc test = 0.5183,0.5299,0.5158,0.5299 auc, acc, f1_macro, f1_micro
INFO:root:

INFO:root:u_extraversion loss = 0.5793
INFO:root:Epoch   376 [2.4 s]
INFO:root:u_extraversion disc test = 0.5194,0.5334,0.5148,0.5334 auc, acc, f1_macro, f1_micro
INFO:root:u_extraversion best auc: 0.5367
INFO:root:And the corresponding u_extraversion best disc test= 0.5367,0.5611,0.5159,0.5611 auc, acc, f1_macro, f1_micro
INFO:root:Load u_extraversion discriminator model from ../model/MLP_FOCF_ValUnf_taobaoserendipity_u_extraversion_neg_sample=1000/u_extraversion_eval_disc.pt
INFO:root:Test After Training = 0.6871,0.1666 ndcg@10,f1@10
INFO:root:User-oriented unfairness: 2.474553485465325e-05
